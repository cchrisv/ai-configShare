{"version":3,"sources":["../../node_modules/tsup/assets/esm_shims.js","../../src/types/adoFieldTypes.ts","../../src/lib/authAzureCli.ts","../../cli/report-tools.ts","../../src/adoActivityReport.ts","../../src/adoClient.ts","../../src/lib/loggerStructured.ts"],"sourcesContent":["// Shim globals in esm bundle\nimport path from 'node:path'\nimport { fileURLToPath } from 'node:url'\n\nconst getFilename = () => fileURLToPath(import.meta.url)\nconst getDirname = () => path.dirname(getFilename())\n\nexport const __dirname = /* @__PURE__ */ getDirname()\nexport const __filename = /* @__PURE__ */ getFilename()\n","/**\n * Azure DevOps Field Types\n * Strongly-typed picklist values for ADO work item fields\n */\n\n// Work Class Type picklist values\nexport type WorkClassType =\n  | 'Critical/Escalation'\n  | 'Development'\n  | 'Fixed Date Delivery'\n  | 'Maintenance/Recurring Tasks'\n  | 'Standard';\n\n// Requires QA picklist values\nexport type RequiresQA = 'Yes' | 'No';\n\n// Priority picklist values\nexport type Priority = 1 | 2 | 3 | 4;\n\n// Severity picklist values\nexport type Severity = '1 - Critical' | '2 - High' | '3 - Medium' | '4 - Low';\n\n// State values for different work item types\nexport type UserStoryState =\n  | 'New'\n  | 'Active'\n  | 'Resolved'\n  | 'Closed'\n  | 'Removed';\n\nexport type TaskState =\n  | 'New'\n  | 'Active'\n  | 'Closed'\n  | 'Removed';\n\nexport type BugState =\n  | 'New'\n  | 'Active'\n  | 'Resolved'\n  | 'Closed';\n\n// Work item types\nexport type WorkItemType =\n  | 'User Story'\n  | 'Task'\n  | 'Bug'\n  | 'Feature'\n  | 'Epic'\n  | 'Issue'\n  | 'Test Case'\n  | 'Test Plan'\n  | 'Test Suite';\n\n// Value Area picklist\nexport type ValueArea = 'Business' | 'Architectural';\n\n// Risk picklist\nexport type Risk = '1 - High' | '2 - Medium' | '3 - Low';\n\n// Reason picklist values (common across types)\nexport type CommonReason =\n  | 'New'\n  | 'Build Failure'\n  | 'Implementation Started'\n  | 'Moved to the backlog'\n  | 'Moved out of the backlog';\n\n// Area Path type (for organizational structure)\nexport type AreaPath = string;\n\n// Iteration Path type (for sprint planning)\nexport type IterationPath = string;\n\n// Constants for ADO configuration\nexport const ADO_RESOURCE_ID = '499b84ac-1321-427f-aa17-267ca6975798';\nexport const DEFAULT_ADO_ORG = 'https://dev.azure.com/UMGC';\nexport const DEFAULT_ADO_PROJECT = 'Digital Platforms';\n\n// Field path constants\nexport const ADO_FIELDS = {\n  // System fields\n  ID: 'System.Id',\n  TITLE: 'System.Title',\n  DESCRIPTION: 'System.Description',\n  STATE: 'System.State',\n  REASON: 'System.Reason',\n  AREA_PATH: 'System.AreaPath',\n  ITERATION_PATH: 'System.IterationPath',\n  WORK_ITEM_TYPE: 'System.WorkItemType',\n  ASSIGNED_TO: 'System.AssignedTo',\n  CREATED_BY: 'System.CreatedBy',\n  CREATED_DATE: 'System.CreatedDate',\n  CHANGED_BY: 'System.ChangedBy',\n  CHANGED_DATE: 'System.ChangedDate',\n  TAGS: 'System.Tags',\n  HISTORY: 'System.History',\n  \n  // Microsoft VSTS Common fields\n  STORY_POINTS: 'Microsoft.VSTS.Scheduling.StoryPoints',\n  PRIORITY: 'Microsoft.VSTS.Common.Priority',\n  SEVERITY: 'Microsoft.VSTS.Common.Severity',\n  VALUE_AREA: 'Microsoft.VSTS.Common.ValueArea',\n  RISK: 'Microsoft.VSTS.Common.Risk',\n  ACCEPTANCE_CRITERIA: 'Microsoft.VSTS.Common.AcceptanceCriteria',\n  \n  // Microsoft VSTS TCM fields (Bug-specific)\n  REPRO_STEPS: 'Microsoft.VSTS.TCM.ReproSteps',\n  SYSTEM_INFO: 'Microsoft.VSTS.TCM.SystemInfo',\n  \n  // Custom fields\n  WORK_CLASS_TYPE: 'Custom.WorkClassType',\n  REQUIRES_QA: 'Custom.RequiresQA',\n  SF_COMPONENTS: 'Custom.SFComponents',\n  TECHNICAL_NOTES: 'Custom.TechnicalNotes',\n  ROOT_CAUSE_DETAIL: 'Custom.RootCauseDetail',\n} as const;\n","/**\n * Azure CLI Authentication\n * Provides bearer token authentication using Azure CLI\n */\n\nimport { execSync } from 'child_process';\nimport { ADO_RESOURCE_ID } from '../types/adoFieldTypes.js';\n\n/**\n * Cache for bearer tokens to avoid repeated CLI calls\n */\ninterface TokenCache {\n  token: string;\n  expiresAt: number;\n}\n\nlet tokenCache: TokenCache | null = null;\nconst TOKEN_EXPIRY_BUFFER_MS = 5 * 60 * 1000; // 5 minutes before expiry\n\n/**\n * Get a bearer token for Azure DevOps using Azure CLI\n * \n * @returns Bearer token string\n * @throws Error if Azure CLI is not authenticated\n */\nexport function getAzureBearerToken(): string {\n  // Check cache first\n  if (tokenCache && Date.now() < tokenCache.expiresAt - TOKEN_EXPIRY_BUFFER_MS) {\n    return tokenCache.token;\n  }\n\n  try {\n    // Get token with expiry info\n    const result = execSync(\n      `az account get-access-token --resource ${ADO_RESOURCE_ID} --query \"{token:accessToken,expiresOn:expiresOn}\" -o json`,\n      { encoding: 'utf-8', stdio: ['pipe', 'pipe', 'pipe'] }\n    );\n\n    const parsed = JSON.parse(result) as { token: string; expiresOn: string };\n    const expiresAt = new Date(parsed.expiresOn).getTime();\n\n    // Cache the token\n    tokenCache = {\n      token: parsed.token,\n      expiresAt,\n    };\n\n    return parsed.token;\n  } catch (error) {\n    // Clear cache on error\n    tokenCache = null;\n\n    if (error instanceof Error) {\n      if (error.message.includes('az: command not found') || \n          error.message.includes('is not recognized')) {\n        throw new Error(\n          'Azure CLI is not installed. Please install it from: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli'\n        );\n      }\n      if (error.message.includes('AADSTS') || \n          error.message.includes('Please run')) {\n        throw new Error(\n          'Azure CLI is not authenticated. Please run: az login'\n        );\n      }\n      throw new Error(`Failed to get Azure bearer token: ${error.message}`);\n    }\n    throw error;\n  }\n}\n\n/**\n * Validate that Azure CLI is authenticated\n * \n * @throws Error if Azure CLI is not installed or not authenticated\n */\nexport function validateAzureAuth(): void {\n  try {\n    execSync('az account show', { \n      encoding: 'utf-8', \n      stdio: ['pipe', 'pipe', 'pipe'] \n    });\n  } catch (error) {\n    if (error instanceof Error) {\n      if (error.message.includes('az: command not found') || \n          error.message.includes('is not recognized')) {\n        throw new Error(\n          'Azure CLI is not installed. Please install it from: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli'\n        );\n      }\n      throw new Error(\n        'Azure CLI is not authenticated. Please run: az login'\n      );\n    }\n    throw error;\n  }\n}\n\n/**\n * Get the current Azure account information\n * \n * @returns Account information including subscription and tenant\n */\nexport function getAzureAccountInfo(): AzureAccountInfo {\n  validateAzureAuth();\n\n  const result = execSync(\n    'az account show --query \"{subscription:name,subscriptionId:id,tenantId:tenantId,user:user.name}\" -o json',\n    { encoding: 'utf-8', stdio: ['pipe', 'pipe', 'pipe'] }\n  );\n\n  return JSON.parse(result) as AzureAccountInfo;\n}\n\n/**\n * Azure account information\n */\nexport interface AzureAccountInfo {\n  subscription: string;\n  subscriptionId: string;\n  tenantId: string;\n  user: string;\n}\n\n/**\n * Clear the token cache (useful for testing or forced refresh)\n */\nexport function clearTokenCache(): void {\n  tokenCache = null;\n}\n","#!/usr/bin/env node\n/**\n * Report Tools CLI\n * Command-line interface for generating Azure DevOps activity reports\n * \n * Usage:\n *   npx report-tools activity --people \"Name|email@domain.com\" --days 30\n */\n\nimport { Command } from 'commander';\nimport { generateActivityReport, parsePerson } from '../src/adoActivityReport.js';\nimport { configureLogger } from '../src/lib/loggerStructured.js';\n\nconst program = new Command();\n\nprogram\n  .name('report-tools')\n  .description('Azure DevOps activity report generation tool')\n  .version('2.0.0');\n\n// Activity report command\nprogram\n  .command('activity')\n  .description('Generate comprehensive activity report for specified users')\n  .requiredOption(\n    '-p, --people <people...>',\n    'People to track in format \"Name|email@domain.com\"'\n  )\n  .option('-d, --days <days>', 'Number of days to look back', '30')\n  .option('-o, --output <dir>', 'Output directory for reports', 'reports')\n  .option('--no-wiki', 'Exclude wiki activities')\n  .option('--no-prs', 'Exclude pull request activities')\n  .option('--fast', 'Fast mode (~20s) - only direct activity, may miss mentions from others')\n  .option('--json', 'Output result as JSON (suppresses progress output)')\n  .option('-q, --quiet', 'Quiet mode - minimal output')\n  .option('-v, --verbose', 'Verbose output with debug information')\n  .action(async (options) => {\n    const startTime = Date.now();\n    \n    try {\n      // Configure logging based on options\n      if (options.json || options.quiet) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      } else {\n        configureLogger({ minLevel: 'info' });\n      }\n\n      // Parse people\n      const people = options.people.map((p: string) => parsePerson(p));\n\n      // Validate input\n      if (people.length === 0) {\n        console.error('Error: At least one person must be specified');\n        console.error('Usage: report-tools activity --people \"Name|email@domain.com\"');\n        process.exit(1);\n      }\n\n      // Validate days\n      const days = parseInt(options.days, 10);\n      if (isNaN(days) || days < 1 || days > 365) {\n        console.error('Error: --days must be a number between 1 and 365');\n        process.exit(1);\n      }\n\n      // Generate report\n      const result = await generateActivityReport({\n        people,\n        days,\n        outputDir: options.output,\n        includeWiki: options.wiki !== false,\n        includePullRequests: options.prs !== false,\n        fast: options.fast,\n      });\n\n      if (options.json) {\n        // JSON output for programmatic use\n        console.log(JSON.stringify({\n          ...result,\n          durationMs: Date.now() - startTime,\n        }, null, 2));\n      } else if (!options.quiet) {\n        // Human-readable output (summary already printed by generateActivityReport)\n        console.log('');\n      }\n\n      process.exit(result.success ? 0 : 1);\n      \n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      const errorStack = error instanceof Error ? error.stack : undefined;\n      \n      if (options.json) {\n        console.log(JSON.stringify({\n          success: false,\n          message: errorMessage,\n          error: {\n            name: error instanceof Error ? error.name : 'Error',\n            message: errorMessage,\n            stack: errorStack,\n          },\n          files: [],\n          activityCounts: {},\n          totalActivities: 0,\n          durationMs: Date.now() - startTime,\n        }, null, 2));\n      } else {\n        console.error('\\n========================================');\n        console.error('              ERROR                     ');\n        console.error('========================================');\n        console.error(`Message: ${errorMessage}`);\n        if (options.verbose && errorStack) {\n          console.error('\\nStack trace:');\n          console.error(errorStack);\n        }\n        console.error('========================================');\n        console.error('\\nTroubleshooting:');\n        console.error('  1. Ensure you are logged in: az login');\n        console.error('  2. Check Azure DevOps access: az account show');\n        console.error('  3. Verify the person name matches ADO exactly');\n        console.error('  4. Run with --verbose for more details');\n      }\n      process.exit(1);\n    }\n  });\n\n// Add help examples\nprogram.addHelpText('after', `\nExamples:\n  $ report-tools activity --people \"John Doe|john.doe@company.com\" --days 30\n  $ report-tools activity --people \"John Doe|john@co.com\" \"Jane Doe|jane@co.com\" --days 7\n  $ report-tools activity --people \"John Doe|john@co.com\" --fast\n  $ report-tools activity --people \"John Doe|john@co.com\" --json > report.json\n\nModes:\n  Default (no flag)  Full scan, ~5min, 100% accuracy - scans all work items\n  --fast             Fast mode, ~20s, ~45% accuracy - only direct activity\n\nOutput:\n  CSV file with columns: Date, WorkItemId, PRNumber, WorkItemType, State,\n  AreaPath, Title, ActivityType, Details, Actor\n`);\n\nprogram.parse();\n","/**\n * Azure DevOps Activity Report Generator\n * Generates comprehensive activity reports for specified users\n */\n\nimport { createWriteStream, mkdirSync, existsSync } from 'fs';\nimport { join } from 'path';\nimport { createAdoConnection, type AdoConnection } from './adoClient.js';\nimport { logInfo, logDebug, logWarn } from './lib/loggerStructured.js';\nimport type {\n  ActivityTarget,\n  ActivityRecord,\n  ActivityReportOptions,\n  ActivityReportResult,\n  ActivityType,\n  WorkItemUpdate,\n} from './types/adoActivityTypes.js';\n\n// Wiki repository ID for Digital Platforms Wiki\nconst WIKI_REPO_ID = 'c7b64b09-35f3-4d8a-889c-5650655281ee';\n\n// Azure DevOps Search API for finding mentions\nconst ADO_ORG = 'UMGC';\nconst ADO_SEARCH_URL = `https://almsearch.dev.azure.com/${ADO_ORG}/_apis/search/workitemsearchresults?api-version=7.1`;\n\n/**\n * Clean HTML tags from text\n */\nfunction cleanHtml(rawHtml: string | null | undefined): string {\n  if (!rawHtml) return '';\n  const cleanText = rawHtml.replace(/<[^>]*>/g, '');\n  return cleanText.replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * Classify mention type based on text content\n */\nfunction classifyMention(text: string): ActivityType {\n  const lowerText = text.toLowerCase();\n\n  // Strong signals for Actionable\n  if (text.includes('?')) return 'ActionableMention';\n  const actionableKeywords = [\n    'please', 'can you', 'could you', 'review', 'approve',\n    'check', 'verify', 'update', 'fix', 'status', 'what is', 'when'\n  ];\n  if (actionableKeywords.some(k => lowerText.includes(k))) {\n    return 'ActionableMention';\n  }\n\n  // Strong signals for FYI\n  const fyiKeywords = [\n    'fyi', 'cc:', 'cc ', 'copying', 'adding',\n    'heads up', 'for info', 'just to note'\n  ];\n  if (fyiKeywords.some(k => lowerText.includes(k))) {\n    return 'FYIMention';\n  }\n\n  // If text is very short, likely a CC\n  const cleanText = lowerText.replace(/@[a-z\\s]+/g, '').trim();\n  if (cleanText.length < 10) return 'FYIMention';\n\n  return 'DiscussionMention';\n}\n\n/**\n * Check if a name/email matches the target\n */\nfunction isMatch(\n  target: ActivityTarget,\n  nameToCheck: string,\n  emailToCheck: string\n): boolean {\n  if (!nameToCheck && !emailToCheck) return false;\n  \n  const nameMatch = target.name && nameToCheck && nameToCheck.toLowerCase().includes(target.name.toLowerCase());\n  const emailMatch = target.email && emailToCheck && emailToCheck.toLowerCase().includes(target.email.toLowerCase());\n  \n  return !!(nameMatch || emailMatch);\n}\n\n/**\n * Fetch work items using WIQL query and return IDs\n */\nasync function queryWorkItemIds(\n  conn: AdoConnection,\n  query: string\n): Promise<number[]> {\n  const witApi = await conn.getWorkItemTrackingApi();\n  const result = await witApi.queryByWiql({ query }, conn.project);\n  \n  if (!result.workItems || result.workItems.length === 0) {\n    return [];\n  }\n  \n  return result.workItems.map(wi => wi.id!).filter(id => id !== undefined);\n}\n\n/**\n * Search for work items mentioning a person using Azure DevOps Search API\n * This is MUCH faster than scanning all work items\n * Uses pagination to get all results\n */\nasync function searchWorkItemsMentioning(\n  conn: AdoConnection,\n  target: ActivityTarget,\n  days: number\n): Promise<number[]> {\n  const { getAzureBearerToken } = await import('./lib/authAzureCli.js');\n  const token = getAzureBearerToken();\n  \n  const searchResults: number[] = [];\n  \n  // Search for mentions of the person's name (use full name as primary search)\n  const searchTerms = [`\"${target.name}\"`];\n  \n  for (const searchTerm of searchTerms) {\n    let skip = 0;\n    const pageSize = 1000;\n    let hasMore = true;\n    \n    while (hasMore) {\n      try {\n        const response = await fetch(ADO_SEARCH_URL, {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            searchText: searchTerm,\n            $skip: skip,\n            $top: pageSize,\n            filters: {\n              'System.TeamProject': [conn.project],\n            },\n            $orderBy: [{ field: 'System.ChangedDate', sortOrder: 'DESC' }],\n            includeFacets: false,\n          }),\n        });\n        \n        if (response.ok) {\n          const data = await response.json() as { \n            count?: number;\n            results?: Array<{ fields?: { 'system.id'?: string } }> \n          };\n          \n          if (data.results) {\n            for (const result of data.results) {\n              const id = parseInt(result.fields?.['system.id'] || '0', 10);\n              if (id > 0) {\n                searchResults.push(id);\n              }\n            }\n            \n            // Check if there are more results\n            hasMore = data.results.length === pageSize && skip < 5000; // Cap at 5000 to avoid endless loops\n            skip += pageSize;\n          } else {\n            hasMore = false;\n          }\n        } else {\n          hasMore = false;\n        }\n      } catch (error) {\n        logWarn(`Search API error for ${searchTerm}: ${error}`);\n        hasMore = false;\n      }\n    }\n    \n    logDebug(`  Search for ${searchTerm} found ${searchResults.length} total results`);\n  }\n  \n  // Return unique IDs\n  return [...new Set(searchResults)];\n}\n\n/**\n * Stream work item revisions using the Reporting API\n * This is a fast way to get all revisions and filter for mentions\n */\nasync function streamRevisionsForMentions(\n  conn: AdoConnection,\n  targets: ActivityTarget[],\n  days: number\n): Promise<number[]> {\n  const { getAzureBearerToken } = await import('./lib/authAzureCli.js');\n  const token = getAzureBearerToken();\n  \n  const startDate = new Date();\n  startDate.setDate(startDate.getDate() - days);\n  const startDateStr = startDate.toISOString();\n  \n  const workItemIds = new Set<number>();\n  let continuationToken: string | null = null;\n  let totalRevisions = 0;\n  const startTime = Date.now();\n  \n  // Build target name patterns for matching\n  const targetPatterns = targets.map(t => t.name.toLowerCase());\n  \n  logInfo(`Streaming revisions since ${startDateStr.split('T')[0]} to find all activity...`);\n  \n  do {\n    try {\n      let url = `https://dev.azure.com/${ADO_ORG}/${encodeURIComponent(conn.project)}/_apis/wit/reporting/workitemrevisions?startDateTime=${encodeURIComponent(startDateStr)}&api-version=7.1`;\n      if (continuationToken) {\n        url += `&continuationToken=${encodeURIComponent(continuationToken)}`;\n      }\n      \n      const response = await fetch(url, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json',\n        },\n      });\n      \n      if (!response.ok) {\n        logWarn(`Reporting API error: ${response.status} ${response.statusText}`);\n        break;\n      }\n      \n      const data = await response.json() as {\n        values?: Array<{\n          id?: number;\n          fields?: Record<string, unknown>;\n        }>;\n        continuationToken?: string;\n        isLastBatch?: boolean;\n      };\n      \n      // Check each revision for target names\n      if (data.values) {\n        for (const revision of data.values) {\n          if (!revision.id) continue;\n          \n          // Check ChangedBy field\n          const changedBy = String(revision.fields?.['System.ChangedBy'] || '').toLowerCase();\n          for (const pattern of targetPatterns) {\n            if (changedBy.includes(pattern)) {\n              workItemIds.add(revision.id);\n              break;\n            }\n          }\n          \n          // Check AssignedTo field\n          const assignedTo = String(revision.fields?.['System.AssignedTo'] || '').toLowerCase();\n          for (const pattern of targetPatterns) {\n            if (assignedTo.includes(pattern)) {\n              workItemIds.add(revision.id);\n              break;\n            }\n          }\n          \n          // Check History field for mentions\n          const history = String(revision.fields?.['System.History'] || '').toLowerCase();\n          if (history) {\n            for (const pattern of targetPatterns) {\n              if (history.includes(pattern)) {\n                workItemIds.add(revision.id);\n                break;\n              }\n            }\n          }\n          \n          // Check Description field for mentions\n          const description = String(revision.fields?.['System.Description'] || '').toLowerCase();\n          if (description) {\n            for (const pattern of targetPatterns) {\n              if (description.includes(pattern)) {\n                workItemIds.add(revision.id);\n                break;\n              }\n            }\n          }\n        }\n        \n        totalRevisions += data.values.length;\n      }\n      \n      continuationToken = data.continuationToken || null;\n      \n      // Progress reporting\n      const elapsed = (Date.now() - startTime) / 1000;\n      if (totalRevisions % 10000 === 0 || !continuationToken) {\n        logInfo(`  Scanned ${totalRevisions} revisions, found ${workItemIds.size} relevant work items (${elapsed.toFixed(1)}s)`);\n      }\n      \n    } catch (error) {\n      logWarn(`Reporting API error: ${error}`);\n      break;\n    }\n    \n  } while (continuationToken);\n  \n  const elapsed = (Date.now() - startTime) / 1000;\n  logInfo(`  Completed: Scanned ${totalRevisions} revisions, found ${workItemIds.size} work items in ${elapsed.toFixed(1)}s`);\n  \n  return Array.from(workItemIds);\n}\n\n/**\n * Fetch work items related to specific people using HYBRID approach\n * For 100% accuracy, scans all recently changed work items\n * Optimized for speed with aggressive parallelization\n */\nasync function fetchHybridWorkItems(\n  conn: AdoConnection,\n  targets: ActivityTarget[],\n  days: number\n): Promise<Array<{ id: number; fields: Record<string, unknown> }>> {\n  const witApi = await conn.getWorkItemTrackingApi();\n  const startTime = Date.now();\n  \n  logInfo(`Fetching ALL work items for 100% accuracy...`);\n  \n  // Get all work items changed in the date range\n  const allRecentQuery = `SELECT [System.Id] FROM WorkItems WHERE [System.ChangedDate] >= @Today - ${days}`;\n  const allRecentIds = await queryWorkItemIds(conn, allRecentQuery);\n  \n  const queryTime = ((Date.now() - startTime) / 1000).toFixed(1);\n  logInfo(`Found ${allRecentIds.length} work items in ${queryTime}s`);\n  \n  if (allRecentIds.length === 0) {\n    return [];\n  }\n  \n  // Fetch full details in aggressive parallel batches\n  const allItems: Array<{ id: number; fields: Record<string, unknown> }> = [];\n  const batchSize = 200;\n  const concurrentBatches = 30; // Very aggressive parallelization\n  \n  const batches: number[][] = [];\n  for (let i = 0; i < allRecentIds.length; i += batchSize) {\n    batches.push(allRecentIds.slice(i, i + batchSize));\n  }\n  \n  for (let i = 0; i < batches.length; i += concurrentBatches) {\n    const batchGroup = batches.slice(i, i + concurrentBatches);\n    \n    const batchPromises = batchGroup.map(batchIds => \n      witApi.getWorkItems(\n        batchIds,\n        ['System.Id', 'System.Title', 'System.WorkItemType', 'System.State', 'System.AreaPath'],\n        undefined,\n        undefined,\n        undefined,\n        conn.project\n      ).catch(() => null)\n    );\n    \n    const batchResults = await Promise.all(batchPromises);\n    \n    for (const items of batchResults) {\n      if (items) {\n        allItems.push(...items.map(item => ({\n          id: item.id!,\n          fields: item.fields as Record<string, unknown>\n        })));\n      }\n    }\n  }\n  \n  const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);\n  logInfo(`Fetched ${allItems.length} work item details in ${totalTime}s`);\n  \n  return allItems;\n}\n\n/**\n * Fetch work items related to specific people (FAST approach - targeted only)\n * Uses targeted WIQL queries instead of scanning all work items\n * Does NOT include mentions from others\n */\nasync function fetchTargetedWorkItems(\n  conn: AdoConnection,\n  targets: ActivityTarget[],\n  days: number\n): Promise<Array<{ id: number; fields: Record<string, unknown> }>> {\n  const witApi = await conn.getWorkItemTrackingApi();\n  \n  logInfo(`Fetching work items for ${targets.length} people in last ${days} days...`);\n  \n  const allIds = new Set<number>();\n  \n  for (const target of targets) {\n    // Query 1: Work items CHANGED BY the person\n    const changedByQuery = `SELECT [System.Id] FROM WorkItems WHERE [System.ChangedBy] = '${target.name}' AND [System.ChangedDate] >= @Today - ${days}`;\n    const changedByIds = await queryWorkItemIds(conn, changedByQuery);\n    logInfo(`  ${target.name}: ${changedByIds.length} items changed by`);\n    changedByIds.forEach(id => allIds.add(id));\n    \n    // Query 2: Work items ASSIGNED TO the person\n    const assignedToQuery = `SELECT [System.Id] FROM WorkItems WHERE [System.AssignedTo] = '${target.name}' AND [System.ChangedDate] >= @Today - ${days}`;\n    const assignedToIds = await queryWorkItemIds(conn, assignedToQuery);\n    logInfo(`  ${target.name}: ${assignedToIds.length} items assigned to`);\n    assignedToIds.forEach(id => allIds.add(id));\n    \n    // Query 3: Work items CREATED BY the person\n    const createdByQuery = `SELECT [System.Id] FROM WorkItems WHERE [System.CreatedBy] = '${target.name}' AND [System.CreatedDate] >= @Today - ${days}`;\n    const createdByIds = await queryWorkItemIds(conn, createdByQuery);\n    logInfo(`  ${target.name}: ${createdByIds.length} items created by`);\n    createdByIds.forEach(id => allIds.add(id));\n  }\n  \n  const uniqueIds = Array.from(allIds);\n  logInfo(`Total unique work items to process: ${uniqueIds.length}`);\n  \n  if (uniqueIds.length === 0) {\n    return [];\n  }\n  \n  // Fetch full details in batches of 200\n  const allItems: Array<{ id: number; fields: Record<string, unknown> }> = [];\n  const batchSize = 200;\n  \n  for (let i = 0; i < uniqueIds.length; i += batchSize) {\n    const batchIds = uniqueIds.slice(i, i + batchSize);\n    const items = await witApi.getWorkItems(\n      batchIds,\n      ['System.Id', 'System.Title', 'System.WorkItemType', 'System.State', 'System.AreaPath'],\n      undefined,\n      undefined,\n      undefined,\n      conn.project\n    );\n    \n    if (items) {\n      allItems.push(...items.map(item => ({\n        id: item.id!,\n        fields: item.fields as Record<string, unknown>\n      })));\n    }\n    \n    logDebug(`Fetched ${allItems.length}/${uniqueIds.length} work items...`);\n  }\n  \n  return allItems;\n}\n\n/**\n * Fetch work items updated in the last N days (complete scan)\n * Uses aggressive parallel batch fetching for speed\n */\nasync function fetchRecentWorkItems(\n  conn: AdoConnection,\n  days: number\n): Promise<Array<{ id: number; fields: Record<string, unknown> }>> {\n  const witApi = await conn.getWorkItemTrackingApi();\n  \n  logInfo(`--- Fetching Work Items ---`);\n  logInfo(`Querying work items changed in last ${days} days...`);\n  \n  const query = `SELECT [System.Id] FROM WorkItems WHERE [System.ChangedDate] >= @Today - ${days} ORDER BY [System.ChangedDate] DESC`;\n  \n  let result;\n  try {\n    result = await witApi.queryByWiql({ query }, conn.project);\n  } catch (error) {\n    logWarn(`WIQL query failed: ${error}`);\n    throw new Error(`Failed to query work items: ${error instanceof Error ? error.message : error}`);\n  }\n  \n  if (!result.workItems || result.workItems.length === 0) {\n    logInfo('No work items found in the specified date range');\n    return [];\n  }\n  \n  const ids = result.workItems.map(wi => wi.id!).filter(id => id !== undefined);\n  logInfo(`Found ${ids.length.toLocaleString()} work items to scan`);\n  \n  // Fetch in parallel batches of 200, with 20 concurrent batch requests\n  const allItems: Array<{ id: number; fields: Record<string, unknown> }> = [];\n  let errors = 0;\n  const batchSize = 200;\n  const concurrentBatches = 20;\n  const startTime = Date.now();\n  \n  // Create all batch ID arrays\n  const batches: number[][] = [];\n  for (let i = 0; i < ids.length; i += batchSize) {\n    batches.push(ids.slice(i, i + batchSize));\n  }\n  \n  logInfo(`Fetching details in ${batches.length} batches (${concurrentBatches} concurrent)...`);\n  \n  // Process batches in parallel groups\n  for (let i = 0; i < batches.length; i += concurrentBatches) {\n    const batchGroup = batches.slice(i, i + concurrentBatches);\n    \n    const batchPromises = batchGroup.map(batchIds => \n      witApi.getWorkItems(\n        batchIds,\n        ['System.Id', 'System.Title', 'System.WorkItemType', 'System.State', 'System.AreaPath'],\n        undefined,\n        undefined,\n        undefined,\n        conn.project\n      ).catch(err => {\n        errors++;\n        logDebug(`Batch fetch error: ${err}`);\n        return null;\n      })\n    );\n    \n    const results = await Promise.all(batchPromises);\n    \n    for (const items of results) {\n      if (items) {\n        allItems.push(...items.map(item => ({\n          id: item.id!,\n          fields: item.fields as Record<string, unknown>\n        })));\n      }\n    }\n  }\n  \n  const elapsed = (Date.now() - startTime) / 1000;\n  logInfo(`Fetched ${allItems.length.toLocaleString()} work items in ${elapsed.toFixed(1)}s${errors > 0 ? ` (${errors} batch errors)` : ''}`);\n  \n  return allItems;\n}\n\n/**\n * Fetch updates for a work item\n */\nasync function fetchWorkItemUpdates(\n  conn: AdoConnection,\n  workItemId: number\n): Promise<WorkItemUpdate[]> {\n  const witApi = await conn.getWorkItemTrackingApi();\n  \n  try {\n    const updates = await witApi.getUpdates(workItemId, conn.project);\n    return (updates || []) as unknown as WorkItemUpdate[];\n  } catch (error) {\n    logWarn(`Failed to fetch updates for work item ${workItemId}: ${error}`);\n    return [];\n  }\n}\n\n/**\n * Process a single work item's updates for activity tracking\n */\nasync function processWorkItem(\n  conn: AdoConnection,\n  item: { id: number; fields: Record<string, unknown> },\n  targets: ActivityTarget[],\n  cutoffDate: Date\n): Promise<ActivityRecord[]> {\n  const activities: ActivityRecord[] = [];\n  const updates = await fetchWorkItemUpdates(conn, item.id);\n  \n  const wiTitle = String(item.fields['System.Title'] || 'No Title');\n  const wiType = String(item.fields['System.WorkItemType'] || 'Unknown');\n  const wiState = String(item.fields['System.State'] || 'Unknown');\n  const wiArea = String(item.fields['System.AreaPath'] || 'Unknown');\n  \n  for (const update of updates) {\n    // Parse update date\n    let updateDate: Date;\n    try {\n      const rawDate = update.revisedDate;\n      if (!rawDate) continue;\n      \n      // Handle both string dates and Date objects\n      updateDate = typeof rawDate === 'string' ? new Date(rawDate) : new Date(rawDate as unknown as string);\n      if (isNaN(updateDate.getTime())) continue;\n    } catch {\n      continue;\n    }\n    \n    // Skip future dates (API artifact)\n    if (updateDate.getFullYear() > 3000) continue;\n    \n    // Skip updates outside our date range (applies to ALL activity types)\n    if (updateDate < cutoffDate) continue;\n    \n    const revisedByName = update.revisedBy?.displayName || '';\n    const revisedByEmail = update.revisedBy?.uniqueName || '';\n    \n    for (const target of targets) {\n      const matched = isMatch(target, revisedByName, revisedByEmail);\n      \n      // 1. Edits/Comments by target\n      if (matched) {\n        if (!update.fields) continue;\n        const changes: string[] = [];\n        let commentText = '';\n        \n        for (const [fieldName, fieldVal] of Object.entries(update.fields)) {\n          if (fieldName === 'System.State') {\n            const oldState = String(fieldVal.oldValue || 'New');\n            const newState = String(fieldVal.newValue || 'Unknown');\n            changes.push(`State: ${oldState}->${newState}`);\n          } else if (fieldName === 'System.History') {\n            commentText = cleanHtml(String(fieldVal.newValue || ''));\n          } else {\n            changes.push(fieldName);\n          }\n        }\n        \n        let activityType: ActivityType = 'Edit';\n        let details = `Changed: ${changes.join(', ')}`;\n        \n        if (update.fields['System.History']) {\n          activityType = 'Comment';\n          if (commentText) {\n            details = `Comment: ${commentText.substring(0, 300)}`;\n          }\n        }\n        \n        activities.push({\n          target: target.name,\n          date: update.revisedDate,\n          workItemId: String(item.id),\n          workItemType: wiType,\n          state: wiState,\n          areaPath: wiArea,\n          title: wiTitle,\n          activityType,\n          details,\n          actor: revisedByName,\n        });\n      }\n      \n      // 2. Mentions and assignments\n      if (update.fields) {\n        for (const [fieldName, fieldVal] of Object.entries(update.fields)) {\n          const newValue = fieldVal.newValue;\n          \n          // Assignment check\n          if (fieldName === 'System.AssignedTo') {\n            let assigneeMatch = false;\n            if (typeof newValue === 'object' && newValue !== null) {\n              const assignee = newValue as { displayName?: string; uniqueName?: string };\n              assigneeMatch = isMatch(target, assignee.displayName || '', assignee.uniqueName || '');\n            } else if (typeof newValue === 'string') {\n              assigneeMatch = isMatch(target, newValue, newValue);\n            }\n            \n            if (assigneeMatch) {\n              activities.push({\n                target: target.name,\n                date: update.revisedDate,\n                workItemId: String(item.id),\n                workItemType: wiType,\n                state: wiState,\n                areaPath: wiArea,\n                title: wiTitle,\n                activityType: 'AssignedTo',\n                details: `Assigned to ${target.name} by ${revisedByName}`,\n                actor: revisedByName,\n              });\n            }\n          }\n          \n          // Mention check in text fields\n          if (typeof newValue === 'string' && fieldName !== 'System.AssignedTo') {\n            const nameInText = target.name && newValue.toLowerCase().includes(target.name.toLowerCase());\n            const emailInText = target.email && newValue.toLowerCase().includes(target.email.toLowerCase());\n            \n            if ((nameInText || emailInText) && !isMatch(target, revisedByName, revisedByEmail)) {\n              const cleanVal = cleanHtml(newValue);\n              const mentionType = classifyMention(cleanVal);\n              \n              activities.push({\n                target: target.name,\n                date: update.revisedDate,\n                workItemId: String(item.id),\n                workItemType: wiType,\n                state: wiState,\n                areaPath: wiArea,\n                title: wiTitle,\n                activityType: mentionType,\n                details: `Mentioned in ${fieldName}: ${cleanVal}`,\n                actor: revisedByName,\n              });\n            }\n          }\n        }\n      }\n      \n      // 3. Relation comments\n      if (update.relations?.added) {\n        for (const link of update.relations.added) {\n          const comment = link.attributes?.comment || '';\n          if (comment && target.name && comment.toLowerCase().includes(target.name.toLowerCase())) {\n            if (!isMatch(target, revisedByName, revisedByEmail)) {\n              const mentionType = classifyMention(comment);\n              activities.push({\n                target: target.name,\n                date: update.revisedDate,\n                workItemId: String(item.id),\n                workItemType: wiType,\n                state: wiState,\n                areaPath: wiArea,\n                title: wiTitle,\n                activityType: mentionType,\n                details: `Mentioned in link comment: ${comment}`,\n                actor: revisedByName,\n              });\n            }\n          }\n        }\n      }\n    }\n  }\n  \n  return activities;\n}\n\n/**\n * Write activities to CSV file\n */\nasync function writeCsvReport(\n  activities: ActivityRecord[],\n  targetName: string,\n  outputDir: string,\n  timestamp: string\n): Promise<string> {\n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:writeCsvReport:entry',message:'writeCsvReport called',data:{activitiesCount:activities.length,targetName,outputDir,timestamp},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2-H3'})}).catch(()=>{});\n  // #endregion\n  \n  // Ensure output directory exists\n  if (!existsSync(outputDir)) {\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:writeCsvReport:mkdir',message:'Creating output directory',data:{outputDir},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H3'})}).catch(()=>{});\n    // #endregion\n    mkdirSync(outputDir, { recursive: true });\n  }\n  \n  const safeName = targetName.toLowerCase().replace(/\\s+/g, '-');\n  const filename = `${safeName}-activity-${timestamp}.csv`;\n  const filepath = join(outputDir, filename);\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:writeCsvReport:filepath',message:'Resolved filepath',data:{filepath,cwd:process.cwd()},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H3'})}).catch(()=>{});\n  // #endregion\n  \n  // Sort by date descending\n  activities.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n  \n  const stream = createWriteStream(filepath, { encoding: 'utf-8' });\n  \n  // #region agent log\n  stream.on('error', (err) => {\n    fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:writeCsvReport:streamError',message:'Stream error occurred',data:{error:String(err),filepath},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H5'})}).catch(()=>{});\n  });\n  // #endregion\n  \n  // Write header\n  const headers = [\n    'Date', 'WorkItemId', 'PRNumber', 'WorkItemType', 'State',\n    'AreaPath', 'Title', 'ActivityType', 'Details', 'Actor'\n  ];\n  stream.write(headers.join(',') + '\\n');\n  \n  // Write rows\n  for (const activity of activities) {\n    const row = [\n      activity.date,\n      activity.workItemId,\n      activity.prNumber || '',\n      activity.workItemType,\n      activity.state,\n      `\"${activity.areaPath.replace(/\"/g, '\"\"')}\"`,\n      `\"${activity.title.replace(/\"/g, '\"\"')}\"`,\n      activity.activityType,\n      `\"${activity.details.replace(/\"/g, '\"\"').substring(0, 500)}\"`,\n      activity.actor,\n    ];\n    stream.write(row.join(',') + '\\n');\n  }\n  \n  // Wait for stream to finish before returning (H1 - stream flush issue)\n  return new Promise((resolve, reject) => {\n    stream.on('finish', () => {\n      // #region agent log\n      fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:writeCsvReport:finish',message:'Stream finished successfully',data:{filepath,activitiesWritten:activities.length},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H1'})}).catch(()=>{});\n      // #endregion\n      resolve(filepath);\n    });\n    stream.on('error', reject);\n    stream.end();\n  });\n}\n\n/**\n * Process work items in parallel batches with production-ready monitoring\n */\nasync function processWorkItemsBatch(\n  conn: AdoConnection,\n  items: Array<{ id: number; fields: Record<string, unknown> }>,\n  targets: ActivityTarget[],\n  cutoffDate: Date,\n  concurrency: number = 100\n): Promise<ActivityRecord[]> {\n  const allActivities: ActivityRecord[] = [];\n  let processed = 0;\n  let errors = 0;\n  let skipped = 0;\n  const total = items.length;\n  const startTime = Date.now();\n  let lastReportTime = startTime;\n  \n  // Track rate over time for better ETA\n  const rateHistory: number[] = [];\n  \n  // Process in batches with concurrency limit\n  for (let i = 0; i < items.length; i += concurrency) {\n    const batch = items.slice(i, i + concurrency);\n    const batchStart = Date.now();\n    \n    const batchPromises = batch.map(item => \n      processWorkItem(conn, item, targets, cutoffDate)\n        .then(activities => ({ success: true, activities, error: null }))\n        .catch(error => ({ success: false, activities: [] as ActivityRecord[], error }))\n    );\n    \n    const batchResults = await Promise.all(batchPromises);\n    \n    for (const result of batchResults) {\n      if (result.success) {\n        allActivities.push(...result.activities);\n        if (result.activities.length === 0) {\n          skipped++;\n        }\n      } else {\n        errors++;\n      }\n    }\n    \n    processed += batch.length;\n    \n    // Calculate batch rate\n    const batchElapsed = (Date.now() - batchStart) / 1000;\n    const batchRate = batch.length / batchElapsed;\n    rateHistory.push(batchRate);\n    if (rateHistory.length > 10) rateHistory.shift(); // Keep last 10 batches\n    \n    // Progress reporting every 10 seconds\n    const now = Date.now();\n    if (processed === total || now - lastReportTime > 10000) {\n      const elapsed = (now - startTime) / 1000;\n      const avgRate = rateHistory.reduce((a, b) => a + b, 0) / rateHistory.length;\n      const remaining = (total - processed) / avgRate;\n      const pct = ((processed / total) * 100).toFixed(1);\n      const eta = new Date(Date.now() + remaining * 1000).toLocaleTimeString();\n      \n      logInfo(`Progress: ${processed}/${total} (${pct}%) | Rate: ${avgRate.toFixed(0)}/sec | ETA: ${eta} | Activities: ${allActivities.length} | Errors: ${errors}`);\n      lastReportTime = now;\n    }\n  }\n  \n  // Final summary\n  const elapsed = (Date.now() - startTime) / 1000;\n  const avgRate = processed / elapsed;\n  \n  logInfo(`--- Processing Complete ---`);\n  logInfo(`  Total work items: ${total}`);\n  logInfo(`  Processed successfully: ${processed - errors}`);\n  logInfo(`  Errors: ${errors} (${((errors / total) * 100).toFixed(1)}%)`);\n  logInfo(`  Items with activity: ${processed - errors - skipped}`);\n  logInfo(`  Activities found: ${allActivities.length}`);\n  logInfo(`  Duration: ${formatDuration(elapsed)}`);\n  logInfo(`  Average rate: ${avgRate.toFixed(0)} items/sec`);\n  \n  return allActivities;\n}\n\n/**\n * Format duration in human-readable format\n */\nfunction formatDuration(seconds: number): string {\n  if (seconds < 60) {\n    return `${seconds.toFixed(1)}s`;\n  } else if (seconds < 3600) {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}m ${secs}s`;\n  } else {\n    const hrs = Math.floor(seconds / 3600);\n    const mins = Math.floor((seconds % 3600) / 60);\n    return `${hrs}h ${mins}m`;\n  }\n}\n\n/**\n * Fetch wiki commits for a target person\n */\nasync function fetchWikiActivities(\n  conn: AdoConnection,\n  target: ActivityTarget,\n  startDate: Date,\n  endDate: Date\n): Promise<ActivityRecord[]> {\n  const activities: ActivityRecord[] = [];\n  \n  try {\n    const gitApi = await conn.getGitApi();\n    \n    // Search by name\n    const commits = await gitApi.getCommits(\n      WIKI_REPO_ID,\n      {\n        author: target.name,\n        fromDate: startDate,\n        toDate: endDate,\n      },\n      conn.project\n    );\n    \n    if (!commits || commits.length === 0) {\n      logInfo(`  No wiki commits found for ${target.name}`);\n      return activities;\n    }\n    \n    logInfo(`  Found ${commits.length} wiki commits for ${target.name}`);\n    \n    for (const commit of commits) {\n      const commitId = commit.commitId?.substring(0, 8) || 'unknown';\n      const comment = commit.comment?.trim() || 'Wiki commit';\n      const authorDate = commit.author?.date;\n      const changeCounts = commit.changeCounts || { Add: 0, Edit: 0, Delete: 0 };\n      \n      // Determine activity type\n      let activityType: ActivityType = 'WikiEdit';\n      if (comment.toLowerCase().startsWith('added')) {\n        activityType = 'WikiCreate';\n      } else if (comment.toLowerCase().includes('page move') || comment.toLowerCase().includes('rename')) {\n        activityType = 'WikiMove';\n      } else if (changeCounts.Delete > 0 && changeCounts.Add === 0 && changeCounts.Edit === 0) {\n        activityType = 'WikiDelete';\n      }\n      \n      activities.push({\n        target: target.name,\n        date: authorDate?.toISOString() || new Date().toISOString(),\n        workItemId: `Wiki:${commitId}`,\n        workItemType: 'Wiki',\n        state: '',\n        areaPath: 'Wiki',\n        title: comment.substring(0, 100),\n        activityType,\n        details: `Changes: +${changeCounts.Add} ~${changeCounts.Edit} -${changeCounts.Delete}`,\n        actor: target.name,\n      });\n    }\n  } catch (error) {\n    logWarn(`Failed to fetch wiki commits for ${target.name}: ${error}`);\n  }\n  \n  return activities;\n}\n\n/**\n * Fetch pull request activities for a target person\n */\nasync function fetchPRActivities(\n  conn: AdoConnection,\n  target: ActivityTarget,\n  startDate: Date,\n  endDate: Date\n): Promise<ActivityRecord[]> {\n  const activities: ActivityRecord[] = [];\n  \n  try {\n    const gitApi = await conn.getGitApi();\n    \n    // Get all repositories\n    const repos = await gitApi.getRepositories(conn.project);\n    if (!repos) return activities;\n    \n    const activeRepos = repos.filter(r => !r.isDisabled);\n    logInfo(`  Scanning ${activeRepos.length} repositories for PR activity...`);\n    \n    const processedPRs = new Set<number>();\n    \n    for (const repo of activeRepos) {\n      if (!repo.id) continue;\n      \n      try {\n        // Get recent PRs\n        const prs = await gitApi.getPullRequests(repo.id, {\n          status: 4, // All statuses\n        }, conn.project, undefined, undefined, 50);\n        \n        if (!prs) continue;\n        \n        for (const pr of prs) {\n          if (!pr.pullRequestId || processedPRs.has(pr.pullRequestId)) continue;\n          \n          const creationDate = pr.creationDate ? new Date(pr.creationDate) : null;\n          const closedDate = pr.closedDate ? new Date(pr.closedDate) : null;\n          \n          // Check if PR is in date range\n          const inRange = (creationDate && creationDate >= startDate && creationDate <= endDate) ||\n                         (closedDate && closedDate >= startDate && closedDate <= endDate);\n          if (!inRange) continue;\n          \n          const prLink = `https://dev.azure.com/UMGC/${conn.project}/_git/${repo.name}/pullrequest/${pr.pullRequestId}`;\n          \n          // Check if created by target\n          const createdByName = pr.createdBy?.displayName || '';\n          const createdByEmail = pr.createdBy?.uniqueName || '';\n          \n          if (isMatch(target, createdByName, createdByEmail) && creationDate && creationDate >= startDate) {\n            processedPRs.add(pr.pullRequestId);\n            activities.push({\n              target: target.name,\n              date: creationDate.toISOString(),\n              workItemId: '',\n              prNumber: String(pr.pullRequestId),\n              workItemType: 'PullRequest',\n              state: '',\n              areaPath: 'Git',\n              title: pr.title || 'Pull Request',\n              activityType: 'PRCreated',\n              details: `Created PR in ${repo.name}`,\n              actor: target.name,\n              link: prLink,\n            });\n          }\n          \n          // Check reviewer votes\n          if (pr.reviewers) {\n            for (const reviewer of pr.reviewers) {\n              const reviewerName = reviewer.displayName || '';\n              const reviewerEmail = reviewer.uniqueName || '';\n              const vote = reviewer.vote || 0;\n              \n              if (isMatch(target, reviewerName, reviewerEmail) && vote !== 0) {\n                let activityType: ActivityType;\n                let details: string;\n                \n                if (vote === 10) {\n                  activityType = 'PRApproved';\n                  details = `Approved PR in ${repo.name}`;\n                } else if (vote === 5) {\n                  activityType = 'PRApprovedWithSuggestions';\n                  details = `Approved with suggestions PR in ${repo.name}`;\n                } else if (vote === -5) {\n                  activityType = 'PRWaitingOnAuthor';\n                  details = `Requested changes on PR in ${repo.name}`;\n                } else if (vote === -10) {\n                  activityType = 'PRRejected';\n                  details = `Rejected PR in ${repo.name}`;\n                } else {\n                  continue;\n                }\n                \n                const voteDate = closedDate || creationDate;\n                if (voteDate) {\n                  activities.push({\n                    target: target.name,\n                    date: voteDate.toISOString(),\n                    workItemId: '',\n                    prNumber: String(pr.pullRequestId),\n                    workItemType: 'PullRequest',\n                    state: '',\n                    areaPath: 'Git',\n                    title: pr.title || 'Pull Request',\n                    activityType,\n                    details,\n                    actor: target.name,\n                    link: prLink,\n                  });\n                }\n              }\n            }\n          }\n        }\n      } catch (repoError) {\n        // Skip repos that fail\n        continue;\n      }\n    }\n    \n    logInfo(`  Found ${activities.length} PR activities for ${target.name}`);\n  } catch (error) {\n    logWarn(`Failed to fetch PR activities for ${target.name}: ${error}`);\n  }\n  \n  return activities;\n}\n\n/**\n * Generate activity report for specified users\n * \n * By default, scans ALL work items to catch all mentions (like Python).\n * Use fast=true to only scan targeted work items (faster but may miss mentions from others).\n */\nexport async function generateActivityReport(\n  options: ActivityReportOptions\n): Promise<ActivityReportResult> {\n  const { \n    people, \n    days, \n    outputDir = 'reports',\n    fast = false,\n    full = false,\n    includeWiki = true,\n    includePullRequests = true,\n  } = options;\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:entry',message:'generateActivityReport called',data:{peopleCount:people.length,people:people.map(p=>p.name),days,outputDir,fast,full,includeWiki,includePullRequests,cwd:process.cwd()},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2-H4'})}).catch(()=>{});\n  // #endregion\n  \n  if (people.length === 0) {\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:noPeople',message:'No people specified - early return',data:{},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2'})}).catch(()=>{});\n    // #endregion\n    return {\n      success: false,\n      message: 'No people specified for report',\n      files: [],\n      activityCounts: {},\n      totalActivities: 0,\n    };\n  }\n  \n  const startTime = Date.now();\n  logInfo(`Generating activity report for ${people.length} people, last ${days} days`);\n  \n  // Determine mode - FULL is default for 100% accuracy\n  let mode: 'fast' | 'hybrid' | 'full';\n  if (fast) {\n    mode = 'fast';\n  } else {\n    mode = 'full'; // Default: 100% accuracy\n  }\n  \n  const modeDescriptions = {\n    fast: 'FAST (targeted only, ~20s, ~45% coverage)',\n    hybrid: 'HYBRID (targeted + search, ~50s, ~90% coverage)',\n    full: 'FULL (comprehensive scan, ~5min, 100% coverage)',\n  };\n  logInfo(`Mode: ${modeDescriptions[mode]}`);\n  \n  for (const p of people) {\n    logInfo(`  - ${p.name} (${p.email})`);\n  }\n  \n  // Create ADO connection\n  const conn = await createAdoConnection();\n  \n  // Calculate cutoff date\n  const cutoffDate = new Date();\n  cutoffDate.setDate(cutoffDate.getDate() - days);\n  const endDate = new Date();\n  \n  // Fetch work items based on mode\n  let workItems: Array<{ id: number; fields: Record<string, unknown> }>;\n  \n  if (mode === 'fast') {\n    // Fast mode: only scan work items the person directly touched (no mentions from others)\n    workItems = await fetchTargetedWorkItems(conn, people, days);\n  } else {\n    // Full mode: scan ALL work items for 100% accuracy\n    workItems = await fetchRecentWorkItems(conn, days);\n  }\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:afterFetchWorkItems',message:'Work items fetched',data:{workItemsCount:workItems.length,mode,sampleIds:workItems.slice(0,5).map(w=>w.id)},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H4'})}).catch(()=>{});\n  // #endregion\n  \n  // Initialize activities by target\n  const activitiesByTarget: Record<string, ActivityRecord[]> = {};\n  for (const p of people) {\n    activitiesByTarget[p.name] = [];\n  }\n  \n  // Run work item processing, wiki, and PR fetching in PARALLEL for maximum speed\n  // Use very high concurrency - accept some rate limit errors for speed\n  const concurrency = mode === 'fast' ? 100 : 150;\n  \n  // Create promises for all three types of activities\n  const workItemPromise = workItems.length > 0 \n    ? (logInfo(`Processing ${workItems.length} work items with ${concurrency} concurrent requests...`),\n       processWorkItemsBatch(conn, workItems, people, cutoffDate, concurrency))\n    : Promise.resolve([] as ActivityRecord[]);\n  \n  const wikiPromise = includeWiki\n    ? (logInfo('Fetching wiki activities in parallel...'),\n       Promise.all(people.map(target => fetchWikiActivities(conn, target, cutoffDate, endDate))))\n    : Promise.resolve(people.map(() => [] as ActivityRecord[]));\n  \n  const prPromise = includePullRequests\n    ? (logInfo('Fetching PR activities in parallel...'),\n       Promise.all(people.map(target => fetchPRActivities(conn, target, cutoffDate, endDate))))\n    : Promise.resolve(people.map(() => [] as ActivityRecord[]));\n  \n  // Wait for all to complete\n  const [workItemActivities, wikiResults, prResults] = await Promise.all([\n    workItemPromise,\n    wikiPromise,\n    prPromise,\n  ]);\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:afterPromiseAll',message:'All activity fetches completed',data:{workItemActivitiesCount:workItemActivities.length,wikiResultsCounts:wikiResults.map(r=>r.length),prResultsCounts:prResults.map(r=>r.length)},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2-H4'})}).catch(()=>{});\n  // #endregion\n  \n  // Group work item activities by target\n  for (const activity of workItemActivities) {\n    if (!activitiesByTarget[activity.target]) {\n      activitiesByTarget[activity.target] = [];\n    }\n    activitiesByTarget[activity.target].push(activity);\n  }\n  \n  // Add wiki activities\n  for (let i = 0; i < people.length; i++) {\n    activitiesByTarget[people[i].name].push(...wikiResults[i]);\n  }\n  \n  // Add PR activities\n  for (let i = 0; i < people.length; i++) {\n    activitiesByTarget[people[i].name].push(...prResults[i]);\n  }\n  \n  // Write CSV files\n  const timestamp = new Date().toISOString().replace(/[:.]/g, '-').substring(0, 19);\n  const files: string[] = [];\n  const activityCounts: Record<string, number> = {};\n  let totalActivities = 0;\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:beforeWriteCsv',message:'About to write CSV files',data:{activitiesByTargetKeys:Object.keys(activitiesByTarget),activitiesByTargetCounts:Object.fromEntries(Object.entries(activitiesByTarget).map(([k,v])=>[k,v.length])),outputDir},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2'})}).catch(()=>{});\n  // #endregion\n  \n  for (const [targetName, activities] of Object.entries(activitiesByTarget)) {\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:loopIteration',message:'Processing target for CSV',data:{targetName,activitiesLength:activities.length,willWrite:activities.length>0},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H2'})}).catch(()=>{});\n    // #endregion\n    \n    if (activities.length > 0) {\n      const filepath = await writeCsvReport(activities, targetName, outputDir, timestamp);\n      files.push(filepath);\n      activityCounts[targetName] = activities.length;\n      totalActivities += activities.length;\n    }\n  }\n  \n  // #region agent log\n  fetch('http://127.0.0.1:7242/ingest/2c547237-6ce5-425f-96fd-6cbcdeebd57b',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'adoActivityReport.ts:generateActivityReport:afterWriteCsv',message:'Finished writing CSV files',data:{filesWritten:files,totalActivities},timestamp:Date.now(),sessionId:'debug-session',hypothesisId:'H1-H2'})}).catch(()=>{});\n  // #endregion\n  \n  // Calculate activity type breakdown\n  const activityTypeBreakdown: Record<string, number> = {};\n  for (const activities of Object.values(activitiesByTarget)) {\n    for (const activity of activities) {\n      activityTypeBreakdown[activity.activityType] = (activityTypeBreakdown[activity.activityType] || 0) + 1;\n    }\n  }\n  \n  // Calculate wiki and PR counts\n  const wikiCount = wikiResults.reduce((sum, arr) => sum + arr.length, 0);\n  const prCount = prResults.reduce((sum, arr) => sum + arr.length, 0);\n  const workItemCount = workItemActivities.length;\n  \n  // Final summary\n  const elapsed = (Date.now() - startTime) / 1000;\n  \n  logInfo('');\n  logInfo('========================================');\n  logInfo('         ACTIVITY REPORT SUMMARY        ');\n  logInfo('========================================');\n  logInfo(`Date Range: ${cutoffDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}`);\n  logInfo(`Mode: ${modeDescriptions[mode]}`);\n  logInfo('');\n  logInfo('--- Sources ---');\n  logInfo(`  Work Items: ${workItemCount} activities`);\n  logInfo(`  Wiki: ${wikiCount} activities`);\n  logInfo(`  Pull Requests: ${prCount} activities`);\n  logInfo('');\n  logInfo('--- Activity Types ---');\n  const sortedTypes = Object.entries(activityTypeBreakdown).sort((a, b) => b[1] - a[1]);\n  for (const [type, count] of sortedTypes) {\n    const pct = ((count / totalActivities) * 100).toFixed(1);\n    logInfo(`  ${type}: ${count} (${pct}%)`);\n  }\n  logInfo('');\n  logInfo('--- Per Person ---');\n  for (const [name, count] of Object.entries(activityCounts)) {\n    logInfo(`  ${name}: ${count} activities`);\n  }\n  logInfo('');\n  logInfo('--- Output ---');\n  for (const file of files) {\n    logInfo(`  ${file}`);\n  }\n  logInfo('');\n  logInfo(`Total: ${totalActivities} activities`);\n  logInfo(`Duration: ${formatDuration(elapsed)}`);\n  logInfo('========================================');\n  \n  return {\n    success: true,\n    message: `Generated ${files.length} report(s) with ${totalActivities} total activities in ${formatDuration(elapsed)}`,\n    files,\n    activityCounts,\n    totalActivities,\n  };\n}\n\n/**\n * Parse person string in format \"Name|email@domain.com\"\n */\nexport function parsePerson(input: string): ActivityTarget {\n  if (input.includes('|')) {\n    const [name, email] = input.split('|');\n    return { name: name.trim(), email: email.trim() };\n  }\n  // If no email provided, use input as name\n  return { name: input.trim(), email: '' };\n}\n","/**\n * Azure DevOps Client\n * Creates authenticated connections to Azure DevOps\n */\n\nimport * as azdev from 'azure-devops-node-api';\nimport type { IWorkItemTrackingApi } from 'azure-devops-node-api/WorkItemTrackingApi.js';\nimport type { IWikiApi } from 'azure-devops-node-api/WikiApi.js';\nimport type { ICoreApi } from 'azure-devops-node-api/CoreApi.js';\nimport type { IGitApi } from 'azure-devops-node-api/GitApi.js';\nimport { getAzureBearerToken, validateAzureAuth } from './lib/authAzureCli.js';\nimport { DEFAULT_ADO_ORG, DEFAULT_ADO_PROJECT } from './types/adoFieldTypes.js';\nimport { logInfo, logDebug } from './lib/loggerStructured.js';\n\n/**\n * ADO connection configuration\n */\nexport interface AdoConnectionConfig {\n  /** Azure DevOps organization URL (default: https://dev.azure.com/UMGC) */\n  orgUrl?: string;\n  /** Project name (default: Digital Platforms) */\n  project?: string;\n  /** Skip auth validation (for testing) */\n  skipAuthValidation?: boolean;\n}\n\n/**\n * ADO connection with APIs\n */\nexport interface AdoConnection {\n  /** The WebApi connection */\n  connection: azdev.WebApi;\n  /** Organization URL */\n  orgUrl: string;\n  /** Project name */\n  project: string;\n  /** Get Work Item Tracking API */\n  getWorkItemTrackingApi: () => Promise<IWorkItemTrackingApi>;\n  /** Get Wiki API */\n  getWikiApi: () => Promise<IWikiApi>;\n  /** Get Core API */\n  getCoreApi: () => Promise<ICoreApi>;\n  /** Get Git API */\n  getGitApi: () => Promise<IGitApi>;\n}\n\n/**\n * Cached connection to avoid re-creating for each operation\n */\nlet cachedConnection: AdoConnection | null = null;\nlet cachedConfig: AdoConnectionConfig | null = null;\n\n/**\n * Check if config has changed\n */\nfunction configChanged(config: AdoConnectionConfig): boolean {\n  if (!cachedConfig) return true;\n  return (\n    config.orgUrl !== cachedConfig.orgUrl ||\n    config.project !== cachedConfig.project\n  );\n}\n\n/**\n * Create an authenticated connection to Azure DevOps\n * \n * @param config - Connection configuration\n * @returns ADO connection with APIs\n */\nexport async function createAdoConnection(\n  config: AdoConnectionConfig = {}\n): Promise<AdoConnection> {\n  const orgUrl = config.orgUrl ?? DEFAULT_ADO_ORG;\n  const project = config.project ?? DEFAULT_ADO_PROJECT;\n\n  // Return cached connection if config hasn't changed\n  if (cachedConnection && !configChanged(config)) {\n    logDebug('Using cached ADO connection');\n    return cachedConnection;\n  }\n\n  logInfo(`Creating ADO connection to ${orgUrl}`);\n\n  // Validate Azure CLI auth\n  if (!config.skipAuthValidation) {\n    validateAzureAuth();\n  }\n\n  // Get bearer token from Azure CLI\n  const token = getAzureBearerToken();\n  \n  // Create auth handler with bearer token\n  const authHandler = azdev.getBearerHandler(token);\n  \n  // Create connection\n  const connection = new azdev.WebApi(orgUrl, authHandler);\n\n  // Create the connection object\n  const adoConnection: AdoConnection = {\n    connection,\n    orgUrl,\n    project,\n    getWorkItemTrackingApi: () => connection.getWorkItemTrackingApi(),\n    getWikiApi: () => connection.getWikiApi(),\n    getCoreApi: () => connection.getCoreApi(),\n    getGitApi: () => connection.getGitApi(),\n  };\n\n  // Cache the connection\n  cachedConnection = adoConnection;\n  cachedConfig = { orgUrl, project };\n\n  logDebug('ADO connection created successfully');\n  return adoConnection;\n}\n\n/**\n * Clear the cached connection (useful for testing or forced refresh)\n */\nexport function clearAdoConnectionCache(): void {\n  cachedConnection = null;\n  cachedConfig = null;\n}\n\n/**\n * Get the Work Item Tracking API\n * Convenience function that creates connection if needed\n */\nexport async function getWorkItemTrackingApi(\n  config?: AdoConnectionConfig\n): Promise<IWorkItemTrackingApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getWorkItemTrackingApi();\n}\n\n/**\n * Get the Wiki API\n * Convenience function that creates connection if needed\n */\nexport async function getWikiApi(\n  config?: AdoConnectionConfig\n): Promise<IWikiApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getWikiApi();\n}\n\n/**\n * Get the Core API\n * Convenience function that creates connection if needed\n */\nexport async function getCoreApi(\n  config?: AdoConnectionConfig\n): Promise<ICoreApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getCoreApi();\n}\n","/**\n * Structured Logger\n * JSON-based logging for consistent output\n */\n\n/**\n * Log levels\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n/**\n * Log entry structure\n */\nexport interface LogEntry {\n  timestamp: string;\n  level: LogLevel;\n  message: string;\n  data?: unknown;\n  context?: LogContext;\n}\n\n/**\n * Log context for tracking operations\n */\nexport interface LogContext {\n  operation?: string;\n  workItemId?: number;\n  sfOrg?: string;\n  duration?: number;\n  [key: string]: unknown;\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  minLevel: LogLevel;\n  jsonOutput: boolean;\n  includeTimestamp: boolean;\n  context?: LogContext;\n  /** When true, suppress all log output (useful for CLI --json mode) */\n  silent: boolean;\n  /** When true, output to stderr instead of stdout */\n  useStderr: boolean;\n}\n\n/**\n * Log level priority (higher = more important)\n */\nconst LOG_LEVEL_PRIORITY: Record<LogLevel, number> = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\n/**\n * Default logger configuration\n */\nlet config: LoggerConfig = {\n  minLevel: 'info',\n  jsonOutput: false,\n  includeTimestamp: true,\n  silent: false,\n  useStderr: false,\n};\n\n/**\n * Configure the logger\n */\nexport function configureLogger(newConfig: Partial<LoggerConfig>): void {\n  config = { ...config, ...newConfig };\n}\n\n/**\n * Get current logger configuration\n */\nexport function getLoggerConfig(): LoggerConfig {\n  return { ...config };\n}\n\n/**\n * Check if a log level should be output\n */\nfunction shouldLog(level: LogLevel): boolean {\n  if (config.silent) return false;\n  return LOG_LEVEL_PRIORITY[level] >= LOG_LEVEL_PRIORITY[config.minLevel];\n}\n\n/**\n * Output a log message to the appropriate stream\n */\nfunction output(level: LogLevel, message: string): void {\n  if (config.useStderr) {\n    console.error(message);\n  } else {\n    switch (level) {\n      case 'debug':\n        console.debug(message);\n        break;\n      case 'info':\n        console.info(message);\n        break;\n      case 'warn':\n        console.warn(message);\n        break;\n      case 'error':\n        console.error(message);\n        break;\n    }\n  }\n}\n\n/**\n * Format a log entry\n */\nfunction formatEntry(entry: LogEntry): string {\n  if (config.jsonOutput) {\n    return JSON.stringify(entry);\n  }\n\n  const parts: string[] = [];\n\n  if (config.includeTimestamp) {\n    parts.push(`[${entry.timestamp}]`);\n  }\n\n  parts.push(`[${entry.level.toUpperCase()}]`);\n  parts.push(entry.message);\n\n  if (entry.data !== undefined) {\n    if (typeof entry.data === 'object') {\n      parts.push(JSON.stringify(entry.data, null, 2));\n    } else {\n      parts.push(String(entry.data));\n    }\n  }\n\n  return parts.join(' ');\n}\n\n/**\n * Create a log entry\n */\nfunction createEntry(level: LogLevel, message: string, data?: unknown, context?: LogContext): LogEntry {\n  return {\n    timestamp: new Date().toISOString(),\n    level,\n    message,\n    data,\n    context: context ?? config.context,\n  };\n}\n\n/**\n * Log a debug message\n */\nexport function logDebug(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('debug')) return;\n  const entry = createEntry('debug', message, data, context);\n  output('debug', formatEntry(entry));\n}\n\n/**\n * Log an info message\n */\nexport function logInfo(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('info')) return;\n  const entry = createEntry('info', message, data, context);\n  output('info', formatEntry(entry));\n}\n\n/**\n * Log a warning message\n */\nexport function logWarn(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('warn')) return;\n  const entry = createEntry('warn', message, data, context);\n  output('warn', formatEntry(entry));\n}\n\n/**\n * Log an error message\n */\nexport function logError(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('error')) return;\n  const entry = createEntry('error', message, data, context);\n  output('error', formatEntry(entry));\n}\n\n/**\n * Log an event (always info level, but with structured event data)\n */\nexport function logEvent(event: string, data?: Record<string, unknown>, context?: LogContext): void {\n  if (!shouldLog('info')) return;\n  const entry = createEntry('info', `[EVENT] ${event}`, data, context);\n  output('info', formatEntry(entry));\n}\n\n/**\n * Create a child logger with additional context\n */\nexport function createChildLogger(additionalContext: LogContext): ChildLogger {\n  return {\n    debug: (message: string, data?: unknown) => logDebug(message, data, additionalContext),\n    info: (message: string, data?: unknown) => logInfo(message, data, additionalContext),\n    warn: (message: string, data?: unknown) => logWarn(message, data, additionalContext),\n    error: (message: string, data?: unknown) => logError(message, data, additionalContext),\n    event: (event: string, data?: Record<string, unknown>) => logEvent(event, data, additionalContext),\n  };\n}\n\n/**\n * Child logger interface\n */\nexport interface ChildLogger {\n  debug: (message: string, data?: unknown) => void;\n  info: (message: string, data?: unknown) => void;\n  warn: (message: string, data?: unknown) => void;\n  error: (message: string, data?: unknown) => void;\n  event: (event: string, data?: Record<string, unknown>) => void;\n}\n\n/**\n * Timer utility for measuring operation duration\n */\nexport function createTimer(): Timer {\n  const startTime = Date.now();\n  return {\n    elapsed: () => Date.now() - startTime,\n    elapsedSeconds: () => (Date.now() - startTime) / 1000,\n    log: (operation: string, level: LogLevel = 'info') => {\n      const duration = Date.now() - startTime;\n      const message = `${operation} completed in ${duration}ms`;\n      const context: LogContext = { operation, duration };\n      \n      switch (level) {\n        case 'debug': logDebug(message, undefined, context); break;\n        case 'info': logInfo(message, undefined, context); break;\n        case 'warn': logWarn(message, undefined, context); break;\n        case 'error': logError(message, undefined, context); break;\n      }\n    },\n  };\n}\n\n/**\n * Timer interface\n */\nexport interface Timer {\n  elapsed: () => number;\n  elapsedSeconds: () => number;\n  log: (operation: string, level?: LogLevel) => void;\n}\n"],"mappings":"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","names":["config","elapsed","avgRate"]}