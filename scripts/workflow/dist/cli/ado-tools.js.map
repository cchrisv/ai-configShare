{"version":3,"sources":["../../cli/ado-tools.ts","../../src/adoWorkItems.ts","../../src/adoClient.ts","../../src/lib/authAzureCli.ts","../../src/types/adoFieldTypes.ts","../../src/lib/loggerStructured.ts","../../src/lib/retryWithBackoff.ts","../../src/lib/validationSchemas.ts","../../src/adoWorkItemLinks.ts","../../src/types/adoLinkTypes.ts"],"sourcesContent":["#!/usr/bin/env node\n/**\n * ADO Tools CLI\n * Command-line interface for Azure DevOps operations\n */\n\nimport { Command } from 'commander';\nimport { readFileSync } from 'fs';\nimport { \n  getWorkItem, \n  updateWorkItem, \n  createWorkItem, \n  searchWorkItems \n} from '../src/adoWorkItems.js';\nimport { linkWorkItems, getWorkItemRelations } from '../src/adoWorkItemLinks.js';\nimport { configureLogger } from '../src/lib/loggerStructured.js';\nimport type { WorkItemType } from '../src/types/adoFieldTypes.js';\nimport type { LinkTypeAlias } from '../src/types/adoLinkTypes.js';\n\nconst program = new Command();\n\nprogram\n  .name('ado-tools')\n  .description('Azure DevOps work item operations')\n  .version('2.0.0');\n\n// Get command\nprogram\n  .command('get <id>')\n  .description('Get a work item by ID')\n  .option('-e, --expand <type>', 'Expand relations (None, Relations, Fields, Links, All)', 'None')\n  .option('-c, --comments', 'Include comments')\n  .option('-f, --fields <fields>', 'Comma-separated list of fields to include')\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (id: string, options) => {\n    try {\n      // Silence logs when outputting JSON to keep stdout clean\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const workItem = await getWorkItem(parseInt(id, 10), {\n        expand: options.expand,\n        includeComments: options.comments,\n        fields: options.fields?.split(','),\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(workItem, null, 2));\n      } else {\n        console.log(`Work Item ${workItem.id}: ${workItem.fields['System.Title']}`);\n        console.log(`  Type: ${workItem.fields['System.WorkItemType']}`);\n        console.log(`  State: ${workItem.fields['System.State']}`);\n        console.log(`  Assigned To: ${workItem.fields['System.AssignedTo'] ?? 'Unassigned'}`);\n        \n        if (workItem.relations && workItem.relations.length > 0) {\n          console.log(`  Relations: ${workItem.relations.length}`);\n        }\n        \n        if (workItem.comments && workItem.comments.length > 0) {\n          console.log(`  Comments: ${workItem.comments.length}`);\n        }\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\n// Update command\nprogram\n  .command('update <id>')\n  .description('Update a work item')\n  // Basic fields (inline)\n  .option('-t, --title <title>', 'New title')\n  .option('-d, --description <description>', 'New description (HTML)')\n  .option('-s, --state <state>', 'New state')\n  .option('--tags <tags>', 'Tags (semicolon-separated, e.g., \"Tag1; Tag2\")')\n  // Acceptance Criteria\n  .option('--ac <criteria>', 'Acceptance criteria (HTML)')\n  .option('--acceptance-criteria <criteria>', 'Acceptance criteria (HTML) - alias for --ac')\n  // Bug-specific fields\n  .option('--repro-steps <steps>', 'Repro steps for bugs (HTML)')\n  .option('--system-info <info>', 'System info for bugs (HTML)')\n  // Numeric/picklist fields\n  .option('--story-points <points>', 'Story points', parseFloat)\n  .option('--priority <priority>', 'Priority (1-4)', parseInt)\n  .option('--work-class <type>', 'Work class type')\n  .option('--requires-qa <value>', 'Requires QA (Yes/No)')\n  // File-based content (for large HTML)\n  .option('--description-file <file>', 'Read description from file')\n  .option('--ac-file <file>', 'Read acceptance criteria from file')\n  .option('--repro-steps-file <file>', 'Read repro steps from file')\n  .option('--system-info-file <file>', 'Read system info from file')\n  // Arbitrary field updates\n  .option('--field <path>', 'Field path for arbitrary update (use with --value)')\n  .option('--value <value>', 'Value for arbitrary field update (use with --field)')\n  .option('--value-file <file>', 'Read value from file for arbitrary field update')\n  // Bulk update from JSON\n  .option('--fields-file <file>', 'Read fields from JSON file (expects { \"fields\": { ... } } or grooming-result.json format)')\n  // Comment\n  .option('--comment <comment>', 'Add a comment/history entry')\n  // Output\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (id: string, options) => {\n    try {\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const fields: Record<string, unknown> = {};\n      \n      // Basic inline fields\n      if (options.title) fields['System.Title'] = options.title;\n      if (options.description) fields['System.Description'] = options.description;\n      if (options.state) fields['System.State'] = options.state;\n      if (options.tags) fields['System.Tags'] = options.tags;\n      \n      // Acceptance criteria (support both --ac and --acceptance-criteria)\n      const acValue = options.ac || options.acceptanceCriteria;\n      if (acValue) fields['Microsoft.VSTS.Common.AcceptanceCriteria'] = acValue;\n      \n      // Bug-specific fields\n      if (options.reproSteps) fields['Microsoft.VSTS.TCM.ReproSteps'] = options.reproSteps;\n      if (options.systemInfo) fields['Microsoft.VSTS.TCM.SystemInfo'] = options.systemInfo;\n      \n      // Numeric/picklist fields\n      if (options.storyPoints) fields['Microsoft.VSTS.Scheduling.StoryPoints'] = options.storyPoints;\n      if (options.priority) fields['Microsoft.VSTS.Common.Priority'] = options.priority;\n      if (options.workClass) fields['Custom.WorkClassType'] = options.workClass;\n      if (options.requiresQa) fields['Custom.RequiresQA'] = options.requiresQa;\n\n      // File-based content (for large HTML that can't be passed inline)\n      if (options.descriptionFile) {\n        fields['System.Description'] = readFileSync(options.descriptionFile, 'utf-8');\n      }\n      if (options.acFile) {\n        fields['Microsoft.VSTS.Common.AcceptanceCriteria'] = readFileSync(options.acFile, 'utf-8');\n      }\n      if (options.reproStepsFile) {\n        fields['Microsoft.VSTS.TCM.ReproSteps'] = readFileSync(options.reproStepsFile, 'utf-8');\n      }\n      if (options.systemInfoFile) {\n        fields['Microsoft.VSTS.TCM.SystemInfo'] = readFileSync(options.systemInfoFile, 'utf-8');\n      }\n\n      // Arbitrary field update (--field + --value or --value-file)\n      if (options.field) {\n        if (options.valueFile) {\n          fields[options.field] = readFileSync(options.valueFile, 'utf-8');\n        } else if (options.value !== undefined) {\n          fields[options.field] = options.value;\n        } else {\n          console.error('Error: --field requires either --value or --value-file');\n          process.exit(1);\n        }\n      }\n\n      // Bulk update from JSON file (grooming-result.json format)\n      if (options.fieldsFile) {\n        const fileContent = readFileSync(options.fieldsFile, 'utf-8');\n        const parsed = JSON.parse(fileContent);\n        \n        // Support both { \"fields\": {...} } and direct fields object\n        const fieldsFromFile = parsed.fields || parsed;\n        \n        // Merge fields from file (file-based fields take precedence over inline)\n        for (const [key, value] of Object.entries(fieldsFromFile)) {\n          if (value !== undefined && value !== null) {\n            fields[key] = value;\n          }\n        }\n      }\n\n      const workItem = await updateWorkItem(parseInt(id, 10), {\n        fields: Object.keys(fields).length > 0 ? fields : undefined,\n        comment: options.comment,\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(workItem, null, 2));\n      } else {\n        console.log(`Updated work item ${workItem.id}`);\n        console.log(`  Fields updated: ${Object.keys(fields).length}`);\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\n// Create command\nprogram\n  .command('create <type>')\n  .description('Create a new work item')\n  .requiredOption('-t, --title <title>', 'Work item title')\n  .option('-d, --description <description>', 'Description')\n  .option('-p, --parent <id>', 'Parent work item ID', parseInt)\n  .option('-a, --area <path>', 'Area path')\n  .option('-i, --iteration <path>', 'Iteration path')\n  .option('--assigned-to <user>', 'Assign to user')\n  .option('--tags <tags>', 'Comma-separated tags')\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (type: string, options) => {\n    try {\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const workItem = await createWorkItem({\n        type: type as WorkItemType,\n        title: options.title,\n        description: options.description,\n        parentId: options.parent,\n        areaPath: options.area,\n        iterationPath: options.iteration,\n        assignedTo: options.assignedTo,\n        tags: options.tags?.split(','),\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(workItem, null, 2));\n      } else {\n        console.log(`Created work item ${workItem.id}: ${workItem.fields['System.Title']}`);\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\n// Search command\nprogram\n  .command('search')\n  .description('Search for work items')\n  .option('-t, --text <text>', 'Search text')\n  .option('--type <type>', 'Work item type')\n  .option('-s, --state <state>', 'State filter')\n  .option('-a, --assigned-to <user>', 'Assigned to filter')\n  .option('--area <path>', 'Area path filter')\n  .option('--iteration <path>', 'Iteration path filter')\n  .option('--tags <tags>', 'Comma-separated tags filter')\n  .option('--wiql <query>', 'Raw WIQL query')\n  .option('--top <n>', 'Maximum results', parseInt)\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (options) => {\n    try {\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const results = await searchWorkItems({\n        searchText: options.text,\n        workItemType: options.type as WorkItemType,\n        state: options.state,\n        assignedTo: options.assignedTo,\n        areaPath: options.area,\n        iterationPath: options.iteration,\n        tags: options.tags?.split(','),\n        wiql: options.wiql,\n        top: options.top,\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(results, null, 2));\n      } else {\n        console.log(`Found ${results.count} work items:`);\n        for (const wi of results.workItems) {\n          console.log(`  ${wi.id}: ${wi.fields['System.Title']} [${wi.fields['System.State']}]`);\n        }\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\n// Link command\nprogram\n  .command('link <sourceId> <targetId>')\n  .description('Link two work items')\n  .requiredOption('--type <type>', 'Link type (parent, child, related, predecessor, successor)')\n  .option('--comment <comment>', 'Link comment')\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (sourceId: string, targetId: string, options) => {\n    try {\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const workItem = await linkWorkItems({\n        sourceId: parseInt(sourceId, 10),\n        targetId: parseInt(targetId, 10),\n        linkType: options.type as LinkTypeAlias,\n        comment: options.comment,\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(workItem, null, 2));\n      } else {\n        console.log(`Linked ${sourceId} -> ${targetId} (${options.type})`);\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\n// Relations command\nprogram\n  .command('relations <id>')\n  .description('Get work item relations')\n  .option('--type <types>', 'Filter by link types (comma-separated)')\n  .option('--json', 'Output as JSON')\n  .option('-v, --verbose', 'Verbose output')\n  .action(async (id: string, options) => {\n    try {\n      if (options.json) {\n        configureLogger({ silent: true });\n      } else if (options.verbose) {\n        configureLogger({ minLevel: 'debug' });\n      }\n\n      const result = await getWorkItemRelations({\n        workItemId: parseInt(id, 10),\n        linkTypes: options.type?.split(',') as LinkTypeAlias[],\n      });\n\n      if (options.json) {\n        console.log(JSON.stringify(result, null, 2));\n      } else {\n        console.log(`Work Item ${id} Relations:`);\n        for (const rel of result.relations) {\n          console.log(`  ${rel.linkType}: ${rel.targetId}`);\n        }\n      }\n    } catch (error) {\n      console.error('Error:', error instanceof Error ? error.message : error);\n      process.exit(1);\n    }\n  });\n\nprogram.parse();\n","/**\n * Azure DevOps Work Items\n * Operations for getting, creating, updating, and searching work items\n */\n\nimport { Operation, type JsonPatchOperation } from 'azure-devops-node-api/interfaces/common/VSSInterfaces.js';\nimport type { \n  WorkItem as AdoWorkItem,\n  WorkItemExpand,\n  Wiql,\n} from 'azure-devops-node-api/interfaces/WorkItemTrackingInterfaces.js';\nimport { createAdoConnection, type AdoConnectionConfig } from './adoClient.js';\nimport { retryWithBackoff, RETRY_PRESETS } from './lib/retryWithBackoff.js';\nimport { logInfo, logDebug, createTimer } from './lib/loggerStructured.js';\nimport { validate, GetWorkItemOptionsSchema, CreateWorkItemOptionsSchema, UpdateWorkItemOptionsSchema, SearchWorkItemsOptionsSchema } from './lib/validationSchemas.js';\nimport type {\n  WorkItem,\n  WorkItemWithComments,\n  WorkItemFields,\n  GetWorkItemOptions,\n  CreateWorkItemOptions,\n  UpdateWorkItemOptions,\n  SearchWorkItemsOptions,\n  WorkItemSearchResult,\n} from './types/adoWorkItemTypes.js';\nimport { ADO_FIELDS } from './types/adoFieldTypes.js';\n\n/**\n * Convert ADO API work item to our WorkItem type\n */\nfunction convertWorkItem(item: AdoWorkItem): WorkItem {\n  return {\n    id: item.id ?? 0,\n    rev: item.rev ?? 0,\n    url: item.url ?? '',\n    fields: (item.fields ?? {}) as WorkItemFields,\n    relations: item.relations?.map(r => ({\n      rel: r.rel ?? '',\n      url: r.url ?? '',\n      attributes: r.attributes ?? {},\n    })) ?? [],\n    _links: item._links as Record<string, { href: string }> | undefined,\n  };\n}\n\n/**\n * Map expand option to API enum\n */\nfunction mapExpandOption(expand?: string): WorkItemExpand | undefined {\n  if (!expand) return undefined;\n  const expandMap: Record<string, WorkItemExpand> = {\n    'None': 0,\n    'Relations': 1,\n    'Fields': 2,\n    'Links': 3,\n    'All': 4,\n  };\n  return expandMap[expand];\n}\n\n/**\n * Get a work item by ID\n * \n * @param id - Work item ID\n * @param options - Get options\n * @param config - Connection config\n * @returns Work item\n */\nexport async function getWorkItem(\n  id: number,\n  options: GetWorkItemOptions = {},\n  config?: AdoConnectionConfig\n): Promise<WorkItemWithComments> {\n  const timer = createTimer();\n  const validatedOptions = validate(GetWorkItemOptionsSchema, options);\n  \n  logInfo(`Getting work item ${id}`, { expand: validatedOptions.expand });\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  const workItem = await retryWithBackoff(\n    () => witApi.getWorkItem(\n      id,\n      validatedOptions.fields,\n      undefined,\n      mapExpandOption(validatedOptions.expand),\n      conn.project\n    ),\n    { ...RETRY_PRESETS.standard, operationName: `getWorkItem(${id})` }\n  );\n\n  if (!workItem) {\n    throw new Error(`Work item ${id} not found`);\n  }\n\n  const result: WorkItemWithComments = convertWorkItem(workItem);\n\n  // Fetch comments if requested\n  if (validatedOptions.includeComments) {\n    logDebug(`Fetching comments for work item ${id}`);\n    const comments = await retryWithBackoff(\n      () => witApi.getComments(conn.project, id),\n      { ...RETRY_PRESETS.standard, operationName: `getComments(${id})` }\n    );\n    \n    result.comments = comments.comments?.map(c => ({\n      id: c.id ?? 0,\n      workItemId: c.workItemId ?? id,\n      text: c.text ?? '',\n      createdBy: {\n        displayName: c.createdBy?.displayName ?? '',\n        url: c.createdBy?.url ?? '',\n        id: c.createdBy?.id ?? '',\n        uniqueName: c.createdBy?.uniqueName ?? '',\n      },\n      createdDate: c.createdDate?.toISOString() ?? '',\n      format: 'html',\n    })) ?? [];\n  }\n\n  timer.log(`getWorkItem(${id})`);\n  return result;\n}\n\n/**\n * Update a work item\n * \n * @param id - Work item ID\n * @param options - Update options\n * @param config - Connection config\n * @returns Updated work item\n */\nexport async function updateWorkItem(\n  id: number,\n  options: UpdateWorkItemOptions,\n  config?: AdoConnectionConfig\n): Promise<WorkItem> {\n  const timer = createTimer();\n  const validatedOptions = validate(UpdateWorkItemOptionsSchema, options);\n\n  logInfo(`Updating work item ${id}`);\n\n  // Build patch document\n  const patchDoc: JsonPatchOperation[] = [];\n\n  // Add fields from options\n  if (validatedOptions.fields) {\n    for (const [key, value] of Object.entries(validatedOptions.fields)) {\n      if (value !== undefined) {\n        patchDoc.push({\n          op: Operation.Add,\n          path: `/fields/${key}`,\n          value,\n        });\n      }\n    }\n  }\n\n\n  // Add comment/history if specified\n  if (validatedOptions.comment) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.HISTORY}`,\n      value: validatedOptions.comment,\n    });\n  }\n\n  if (patchDoc.length === 0) {\n    logDebug('No updates to apply');\n    return getWorkItem(id, {}, config);\n  }\n\n  logDebug(`Applying ${patchDoc.length} patch operations`);\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  const updatedItem = await retryWithBackoff(\n    () => witApi.updateWorkItem(\n      undefined, // customHeaders\n      patchDoc,\n      id,\n      conn.project\n    ),\n    { ...RETRY_PRESETS.standard, operationName: `updateWorkItem(${id})` }\n  );\n\n  if (!updatedItem) {\n    throw new Error(`Failed to update work item ${id}`);\n  }\n\n  timer.log(`updateWorkItem(${id})`);\n  return convertWorkItem(updatedItem);\n}\n\n/**\n * Create a new work item\n * \n * @param options - Create options\n * @param config - Connection config\n * @returns Created work item\n */\nexport async function createWorkItem(\n  options: CreateWorkItemOptions,\n  config?: AdoConnectionConfig\n): Promise<WorkItem> {\n  const timer = createTimer();\n  const validatedOptions = validate(CreateWorkItemOptionsSchema, options);\n\n  logInfo(`Creating ${validatedOptions.type} work item: ${validatedOptions.title}`);\n\n  // Build patch document\n  const patchDoc: JsonPatchOperation[] = [];\n\n  // Required: Title\n  patchDoc.push({\n    op: Operation.Add,\n    path: `/fields/${ADO_FIELDS.TITLE}`,\n    value: validatedOptions.title,\n  });\n\n  // Optional fields\n  if (validatedOptions.description) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.DESCRIPTION}`,\n      value: validatedOptions.description,\n    });\n  }\n\n  if (validatedOptions.areaPath) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.AREA_PATH}`,\n      value: validatedOptions.areaPath,\n    });\n  }\n\n  if (validatedOptions.iterationPath) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.ITERATION_PATH}`,\n      value: validatedOptions.iterationPath,\n    });\n  }\n\n  if (validatedOptions.assignedTo) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.ASSIGNED_TO}`,\n      value: validatedOptions.assignedTo,\n    });\n  }\n\n  if (validatedOptions.tags && validatedOptions.tags.length > 0) {\n    patchDoc.push({\n      op: Operation.Add,\n      path: `/fields/${ADO_FIELDS.TAGS}`,\n      value: validatedOptions.tags.join('; '),\n    });\n  }\n\n  // Add parent link if specified\n  if (validatedOptions.parentId) {\n    const conn = await createAdoConnection(config);\n    patchDoc.push({\n      op: Operation.Add,\n      path: '/relations/-',\n      value: {\n        rel: 'System.LinkTypes.Hierarchy-Reverse',\n        url: `${conn.orgUrl}/${conn.project}/_apis/wit/workItems/${validatedOptions.parentId}`,\n      },\n    });\n  }\n\n  // Add any additional fields\n  if (validatedOptions.additionalFields) {\n    for (const [key, value] of Object.entries(validatedOptions.additionalFields)) {\n      if (value !== undefined && !key.startsWith('System.')) {\n        patchDoc.push({\n          op: Operation.Add,\n          path: `/fields/${key}`,\n          value,\n        });\n      }\n    }\n  }\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  const createdItem = await retryWithBackoff(\n    () => witApi.createWorkItem(\n      undefined, // customHeaders\n      patchDoc,\n      conn.project,\n      validatedOptions.type\n    ),\n    { ...RETRY_PRESETS.standard, operationName: 'createWorkItem' }\n  );\n\n  if (!createdItem) {\n    throw new Error('Failed to create work item');\n  }\n\n  logInfo(`Created work item ${createdItem.id}`);\n  timer.log('createWorkItem');\n  return convertWorkItem(createdItem);\n}\n\n/**\n * Search for work items\n * \n * @param options - Search options\n * @param config - Connection config\n * @returns Search results\n */\nexport async function searchWorkItems(\n  options: SearchWorkItemsOptions,\n  config?: AdoConnectionConfig\n): Promise<WorkItemSearchResult> {\n  const timer = createTimer();\n  const validatedOptions = validate(SearchWorkItemsOptionsSchema, options);\n\n  logInfo('Searching work items', validatedOptions);\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  let wiqlQuery: string;\n\n  if (validatedOptions.wiql) {\n    // Use provided WIQL directly\n    wiqlQuery = validatedOptions.wiql;\n  } else {\n    // Build WIQL from options\n    const conditions: string[] = [];\n\n    if (validatedOptions.searchText) {\n      conditions.push(`[System.Title] CONTAINS '${validatedOptions.searchText}'`);\n    }\n\n    if (validatedOptions.workItemType) {\n      conditions.push(`[System.WorkItemType] = '${validatedOptions.workItemType}'`);\n    }\n\n    if (validatedOptions.state) {\n      conditions.push(`[System.State] = '${validatedOptions.state}'`);\n    }\n\n    if (validatedOptions.assignedTo) {\n      conditions.push(`[System.AssignedTo] = '${validatedOptions.assignedTo}'`);\n    }\n\n    if (validatedOptions.areaPath) {\n      conditions.push(`[System.AreaPath] UNDER '${validatedOptions.areaPath}'`);\n    }\n\n    if (validatedOptions.iterationPath) {\n      conditions.push(`[System.IterationPath] UNDER '${validatedOptions.iterationPath}'`);\n    }\n\n    if (validatedOptions.tags && validatedOptions.tags.length > 0) {\n      for (const tag of validatedOptions.tags) {\n        conditions.push(`[System.Tags] CONTAINS '${tag}'`);\n      }\n    }\n\n    const whereClause = conditions.length > 0 \n      ? `WHERE ${conditions.join(' AND ')}` \n      : '';\n\n    // WIQL format: SELECT [fields] FROM WorkItems WHERE ... ORDER BY ...\n    // Note: WIQL doesn't support TOP in the query - we limit in code instead\n    wiqlQuery = `SELECT [System.Id] FROM WorkItems ${whereClause} ORDER BY [System.ChangedDate] DESC`;\n  }\n\n  logDebug('Executing WIQL', { wiql: wiqlQuery });\n\n  const wiql: Wiql = { query: wiqlQuery };\n\n  const queryResult = await retryWithBackoff(\n    () => witApi.queryByWiql(wiql, { project: conn.project }),\n    { ...RETRY_PRESETS.standard, operationName: 'queryByWiql' }\n  );\n\n  if (!queryResult.workItems || queryResult.workItems.length === 0) {\n    logDebug('No work items found');\n    return { workItems: [], count: 0 };\n  }\n\n  // Get full work item details\n  let ids = queryResult.workItems\n    .map(wi => wi.id)\n    .filter((id): id is number => id !== undefined);\n\n  // Apply top limit if specified\n  if (validatedOptions.top && ids.length > validatedOptions.top) {\n    ids = ids.slice(0, validatedOptions.top);\n  }\n\n  logDebug(`Found ${ids.length} work items, fetching details`);\n\n  // Azure DevOps API has a 200 work item limit per request\n  // Fetch in batches to handle larger result sets\n  const BATCH_SIZE = 200;\n  const allWorkItems: AdoWorkItem[] = [];\n  \n  for (let i = 0; i < ids.length; i += BATCH_SIZE) {\n    const batchIds = ids.slice(i, i + BATCH_SIZE);\n    logDebug(`Fetching batch ${Math.floor(i / BATCH_SIZE) + 1} of ${Math.ceil(ids.length / BATCH_SIZE)} (${batchIds.length} items)`);\n    \n    const batchWorkItems = await retryWithBackoff(\n      () => witApi.getWorkItems(batchIds, undefined, undefined, undefined, undefined, conn.project),\n      { ...RETRY_PRESETS.standard, operationName: `getWorkItems(batch ${Math.floor(i / BATCH_SIZE) + 1})` }\n    );\n    \n    allWorkItems.push(...batchWorkItems.filter((wi): wi is AdoWorkItem => wi !== null));\n  }\n\n  const results = allWorkItems.map(convertWorkItem);\n\n  timer.log('searchWorkItems');\n  return {\n    workItems: results,\n    count: results.length,\n  };\n}\n","/**\n * Azure DevOps Client\n * Creates authenticated connections to Azure DevOps\n */\n\nimport * as azdev from 'azure-devops-node-api';\nimport type { IWorkItemTrackingApi } from 'azure-devops-node-api/WorkItemTrackingApi.js';\nimport type { IWikiApi } from 'azure-devops-node-api/WikiApi.js';\nimport type { ICoreApi } from 'azure-devops-node-api/CoreApi.js';\nimport type { IGitApi } from 'azure-devops-node-api/GitApi.js';\nimport { getAzureBearerToken, validateAzureAuth } from './lib/authAzureCli.js';\nimport { DEFAULT_ADO_ORG, DEFAULT_ADO_PROJECT } from './types/adoFieldTypes.js';\nimport { logInfo, logDebug } from './lib/loggerStructured.js';\n\n/**\n * ADO connection configuration\n */\nexport interface AdoConnectionConfig {\n  /** Azure DevOps organization URL (default: https://dev.azure.com/UMGC) */\n  orgUrl?: string;\n  /** Project name (default: Digital Platforms) */\n  project?: string;\n  /** Skip auth validation (for testing) */\n  skipAuthValidation?: boolean;\n}\n\n/**\n * ADO connection with APIs\n */\nexport interface AdoConnection {\n  /** The WebApi connection */\n  connection: azdev.WebApi;\n  /** Organization URL */\n  orgUrl: string;\n  /** Project name */\n  project: string;\n  /** Get Work Item Tracking API */\n  getWorkItemTrackingApi: () => Promise<IWorkItemTrackingApi>;\n  /** Get Wiki API */\n  getWikiApi: () => Promise<IWikiApi>;\n  /** Get Core API */\n  getCoreApi: () => Promise<ICoreApi>;\n  /** Get Git API */\n  getGitApi: () => Promise<IGitApi>;\n}\n\n/**\n * Cached connection to avoid re-creating for each operation\n */\nlet cachedConnection: AdoConnection | null = null;\nlet cachedConfig: AdoConnectionConfig | null = null;\n\n/**\n * Check if config has changed\n */\nfunction configChanged(config: AdoConnectionConfig): boolean {\n  if (!cachedConfig) return true;\n  return (\n    config.orgUrl !== cachedConfig.orgUrl ||\n    config.project !== cachedConfig.project\n  );\n}\n\n/**\n * Create an authenticated connection to Azure DevOps\n * \n * @param config - Connection configuration\n * @returns ADO connection with APIs\n */\nexport async function createAdoConnection(\n  config: AdoConnectionConfig = {}\n): Promise<AdoConnection> {\n  const orgUrl = config.orgUrl ?? DEFAULT_ADO_ORG;\n  const project = config.project ?? DEFAULT_ADO_PROJECT;\n\n  // Return cached connection if config hasn't changed\n  if (cachedConnection && !configChanged(config)) {\n    logDebug('Using cached ADO connection');\n    return cachedConnection;\n  }\n\n  logInfo(`Creating ADO connection to ${orgUrl}`);\n\n  // Validate Azure CLI auth\n  if (!config.skipAuthValidation) {\n    validateAzureAuth();\n  }\n\n  // Get bearer token from Azure CLI\n  const token = getAzureBearerToken();\n  \n  // Create auth handler with bearer token\n  const authHandler = azdev.getBearerHandler(token);\n  \n  // Create connection\n  const connection = new azdev.WebApi(orgUrl, authHandler);\n\n  // Create the connection object\n  const adoConnection: AdoConnection = {\n    connection,\n    orgUrl,\n    project,\n    getWorkItemTrackingApi: () => connection.getWorkItemTrackingApi(),\n    getWikiApi: () => connection.getWikiApi(),\n    getCoreApi: () => connection.getCoreApi(),\n    getGitApi: () => connection.getGitApi(),\n  };\n\n  // Cache the connection\n  cachedConnection = adoConnection;\n  cachedConfig = { orgUrl, project };\n\n  logDebug('ADO connection created successfully');\n  return adoConnection;\n}\n\n/**\n * Clear the cached connection (useful for testing or forced refresh)\n */\nexport function clearAdoConnectionCache(): void {\n  cachedConnection = null;\n  cachedConfig = null;\n}\n\n/**\n * Get the Work Item Tracking API\n * Convenience function that creates connection if needed\n */\nexport async function getWorkItemTrackingApi(\n  config?: AdoConnectionConfig\n): Promise<IWorkItemTrackingApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getWorkItemTrackingApi();\n}\n\n/**\n * Get the Wiki API\n * Convenience function that creates connection if needed\n */\nexport async function getWikiApi(\n  config?: AdoConnectionConfig\n): Promise<IWikiApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getWikiApi();\n}\n\n/**\n * Get the Core API\n * Convenience function that creates connection if needed\n */\nexport async function getCoreApi(\n  config?: AdoConnectionConfig\n): Promise<ICoreApi> {\n  const conn = await createAdoConnection(config);\n  return conn.getCoreApi();\n}\n","/**\n * Azure CLI Authentication\n * Provides bearer token authentication using Azure CLI\n */\n\nimport { execSync } from 'child_process';\nimport { ADO_RESOURCE_ID } from '../types/adoFieldTypes.js';\n\n/**\n * Cache for bearer tokens to avoid repeated CLI calls\n */\ninterface TokenCache {\n  token: string;\n  expiresAt: number;\n}\n\nlet tokenCache: TokenCache | null = null;\nconst TOKEN_EXPIRY_BUFFER_MS = 5 * 60 * 1000; // 5 minutes before expiry\n\n/**\n * Get a bearer token for Azure DevOps using Azure CLI\n * \n * @returns Bearer token string\n * @throws Error if Azure CLI is not authenticated\n */\nexport function getAzureBearerToken(): string {\n  // Check cache first\n  if (tokenCache && Date.now() < tokenCache.expiresAt - TOKEN_EXPIRY_BUFFER_MS) {\n    return tokenCache.token;\n  }\n\n  try {\n    // Get token with expiry info\n    const result = execSync(\n      `az account get-access-token --resource ${ADO_RESOURCE_ID} --query \"{token:accessToken,expiresOn:expiresOn}\" -o json`,\n      { encoding: 'utf-8', stdio: ['pipe', 'pipe', 'pipe'] }\n    );\n\n    const parsed = JSON.parse(result) as { token: string; expiresOn: string };\n    const expiresAt = new Date(parsed.expiresOn).getTime();\n\n    // Cache the token\n    tokenCache = {\n      token: parsed.token,\n      expiresAt,\n    };\n\n    return parsed.token;\n  } catch (error) {\n    // Clear cache on error\n    tokenCache = null;\n\n    if (error instanceof Error) {\n      if (error.message.includes('az: command not found') || \n          error.message.includes('is not recognized')) {\n        throw new Error(\n          'Azure CLI is not installed. Please install it from: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli'\n        );\n      }\n      if (error.message.includes('AADSTS') || \n          error.message.includes('Please run')) {\n        throw new Error(\n          'Azure CLI is not authenticated. Please run: az login'\n        );\n      }\n      throw new Error(`Failed to get Azure bearer token: ${error.message}`);\n    }\n    throw error;\n  }\n}\n\n/**\n * Validate that Azure CLI is authenticated\n * \n * @throws Error if Azure CLI is not installed or not authenticated\n */\nexport function validateAzureAuth(): void {\n  try {\n    execSync('az account show', { \n      encoding: 'utf-8', \n      stdio: ['pipe', 'pipe', 'pipe'] \n    });\n  } catch (error) {\n    if (error instanceof Error) {\n      if (error.message.includes('az: command not found') || \n          error.message.includes('is not recognized')) {\n        throw new Error(\n          'Azure CLI is not installed. Please install it from: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli'\n        );\n      }\n      throw new Error(\n        'Azure CLI is not authenticated. Please run: az login'\n      );\n    }\n    throw error;\n  }\n}\n\n/**\n * Get the current Azure account information\n * \n * @returns Account information including subscription and tenant\n */\nexport function getAzureAccountInfo(): AzureAccountInfo {\n  validateAzureAuth();\n\n  const result = execSync(\n    'az account show --query \"{subscription:name,subscriptionId:id,tenantId:tenantId,user:user.name}\" -o json',\n    { encoding: 'utf-8', stdio: ['pipe', 'pipe', 'pipe'] }\n  );\n\n  return JSON.parse(result) as AzureAccountInfo;\n}\n\n/**\n * Azure account information\n */\nexport interface AzureAccountInfo {\n  subscription: string;\n  subscriptionId: string;\n  tenantId: string;\n  user: string;\n}\n\n/**\n * Clear the token cache (useful for testing or forced refresh)\n */\nexport function clearTokenCache(): void {\n  tokenCache = null;\n}\n","/**\n * Azure DevOps Field Types\n * Strongly-typed picklist values for ADO work item fields\n */\n\n// Work Class Type picklist values\nexport type WorkClassType =\n  | 'Critical/Escalation'\n  | 'Development'\n  | 'Fixed Date Delivery'\n  | 'Maintenance/Recurring Tasks'\n  | 'Standard';\n\n// Requires QA picklist values\nexport type RequiresQA = 'Yes' | 'No';\n\n// Priority picklist values\nexport type Priority = 1 | 2 | 3 | 4;\n\n// Severity picklist values\nexport type Severity = '1 - Critical' | '2 - High' | '3 - Medium' | '4 - Low';\n\n// State values for different work item types\nexport type UserStoryState =\n  | 'New'\n  | 'Active'\n  | 'Resolved'\n  | 'Closed'\n  | 'Removed';\n\nexport type TaskState =\n  | 'New'\n  | 'Active'\n  | 'Closed'\n  | 'Removed';\n\nexport type BugState =\n  | 'New'\n  | 'Active'\n  | 'Resolved'\n  | 'Closed';\n\n// Work item types\nexport type WorkItemType =\n  | 'User Story'\n  | 'Task'\n  | 'Bug'\n  | 'Feature'\n  | 'Epic'\n  | 'Issue'\n  | 'Test Case'\n  | 'Test Plan'\n  | 'Test Suite';\n\n// Value Area picklist\nexport type ValueArea = 'Business' | 'Architectural';\n\n// Risk picklist\nexport type Risk = '1 - High' | '2 - Medium' | '3 - Low';\n\n// Reason picklist values (common across types)\nexport type CommonReason =\n  | 'New'\n  | 'Build Failure'\n  | 'Implementation Started'\n  | 'Moved to the backlog'\n  | 'Moved out of the backlog';\n\n// Area Path type (for organizational structure)\nexport type AreaPath = string;\n\n// Iteration Path type (for sprint planning)\nexport type IterationPath = string;\n\n// Constants for ADO configuration\nexport const ADO_RESOURCE_ID = '499b84ac-1321-427f-aa17-267ca6975798';\nexport const DEFAULT_ADO_ORG = 'https://dev.azure.com/UMGC';\nexport const DEFAULT_ADO_PROJECT = 'Digital Platforms';\n\n// Field path constants\nexport const ADO_FIELDS = {\n  // System fields\n  ID: 'System.Id',\n  TITLE: 'System.Title',\n  DESCRIPTION: 'System.Description',\n  STATE: 'System.State',\n  REASON: 'System.Reason',\n  AREA_PATH: 'System.AreaPath',\n  ITERATION_PATH: 'System.IterationPath',\n  WORK_ITEM_TYPE: 'System.WorkItemType',\n  ASSIGNED_TO: 'System.AssignedTo',\n  CREATED_BY: 'System.CreatedBy',\n  CREATED_DATE: 'System.CreatedDate',\n  CHANGED_BY: 'System.ChangedBy',\n  CHANGED_DATE: 'System.ChangedDate',\n  TAGS: 'System.Tags',\n  HISTORY: 'System.History',\n  \n  // Microsoft VSTS Common fields\n  STORY_POINTS: 'Microsoft.VSTS.Scheduling.StoryPoints',\n  PRIORITY: 'Microsoft.VSTS.Common.Priority',\n  SEVERITY: 'Microsoft.VSTS.Common.Severity',\n  VALUE_AREA: 'Microsoft.VSTS.Common.ValueArea',\n  RISK: 'Microsoft.VSTS.Common.Risk',\n  ACCEPTANCE_CRITERIA: 'Microsoft.VSTS.Common.AcceptanceCriteria',\n  \n  // Microsoft VSTS TCM fields (Bug-specific)\n  REPRO_STEPS: 'Microsoft.VSTS.TCM.ReproSteps',\n  SYSTEM_INFO: 'Microsoft.VSTS.TCM.SystemInfo',\n  \n  // Custom fields\n  WORK_CLASS_TYPE: 'Custom.WorkClassType',\n  REQUIRES_QA: 'Custom.RequiresQA',\n  SF_COMPONENTS: 'Custom.SFComponents',\n  TECHNICAL_NOTES: 'Custom.TechnicalNotes',\n  ROOT_CAUSE_DETAIL: 'Custom.RootCauseDetail',\n} as const;\n","/**\n * Structured Logger\n * JSON-based logging for consistent output\n */\n\n/**\n * Log levels\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n/**\n * Log entry structure\n */\nexport interface LogEntry {\n  timestamp: string;\n  level: LogLevel;\n  message: string;\n  data?: unknown;\n  context?: LogContext;\n}\n\n/**\n * Log context for tracking operations\n */\nexport interface LogContext {\n  operation?: string;\n  workItemId?: number;\n  sfOrg?: string;\n  duration?: number;\n  [key: string]: unknown;\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  minLevel: LogLevel;\n  jsonOutput: boolean;\n  includeTimestamp: boolean;\n  context?: LogContext;\n  /** When true, suppress all log output (useful for CLI --json mode) */\n  silent: boolean;\n  /** When true, output to stderr instead of stdout */\n  useStderr: boolean;\n}\n\n/**\n * Log level priority (higher = more important)\n */\nconst LOG_LEVEL_PRIORITY: Record<LogLevel, number> = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\n/**\n * Default logger configuration\n */\nlet config: LoggerConfig = {\n  minLevel: 'info',\n  jsonOutput: false,\n  includeTimestamp: true,\n  silent: false,\n  useStderr: false,\n};\n\n/**\n * Configure the logger\n */\nexport function configureLogger(newConfig: Partial<LoggerConfig>): void {\n  config = { ...config, ...newConfig };\n}\n\n/**\n * Get current logger configuration\n */\nexport function getLoggerConfig(): LoggerConfig {\n  return { ...config };\n}\n\n/**\n * Check if a log level should be output\n */\nfunction shouldLog(level: LogLevel): boolean {\n  if (config.silent) return false;\n  return LOG_LEVEL_PRIORITY[level] >= LOG_LEVEL_PRIORITY[config.minLevel];\n}\n\n/**\n * Output a log message to the appropriate stream\n */\nfunction output(level: LogLevel, message: string): void {\n  if (config.useStderr) {\n    console.error(message);\n  } else {\n    switch (level) {\n      case 'debug':\n        console.debug(message);\n        break;\n      case 'info':\n        console.info(message);\n        break;\n      case 'warn':\n        console.warn(message);\n        break;\n      case 'error':\n        console.error(message);\n        break;\n    }\n  }\n}\n\n/**\n * Format a log entry\n */\nfunction formatEntry(entry: LogEntry): string {\n  if (config.jsonOutput) {\n    return JSON.stringify(entry);\n  }\n\n  const parts: string[] = [];\n\n  if (config.includeTimestamp) {\n    parts.push(`[${entry.timestamp}]`);\n  }\n\n  parts.push(`[${entry.level.toUpperCase()}]`);\n  parts.push(entry.message);\n\n  if (entry.data !== undefined) {\n    if (typeof entry.data === 'object') {\n      parts.push(JSON.stringify(entry.data, null, 2));\n    } else {\n      parts.push(String(entry.data));\n    }\n  }\n\n  return parts.join(' ');\n}\n\n/**\n * Create a log entry\n */\nfunction createEntry(level: LogLevel, message: string, data?: unknown, context?: LogContext): LogEntry {\n  return {\n    timestamp: new Date().toISOString(),\n    level,\n    message,\n    data,\n    context: context ?? config.context,\n  };\n}\n\n/**\n * Log a debug message\n */\nexport function logDebug(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('debug')) return;\n  const entry = createEntry('debug', message, data, context);\n  output('debug', formatEntry(entry));\n}\n\n/**\n * Log an info message\n */\nexport function logInfo(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('info')) return;\n  const entry = createEntry('info', message, data, context);\n  output('info', formatEntry(entry));\n}\n\n/**\n * Log a warning message\n */\nexport function logWarn(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('warn')) return;\n  const entry = createEntry('warn', message, data, context);\n  output('warn', formatEntry(entry));\n}\n\n/**\n * Log an error message\n */\nexport function logError(message: string, data?: unknown, context?: LogContext): void {\n  if (!shouldLog('error')) return;\n  const entry = createEntry('error', message, data, context);\n  output('error', formatEntry(entry));\n}\n\n/**\n * Log an event (always info level, but with structured event data)\n */\nexport function logEvent(event: string, data?: Record<string, unknown>, context?: LogContext): void {\n  if (!shouldLog('info')) return;\n  const entry = createEntry('info', `[EVENT] ${event}`, data, context);\n  output('info', formatEntry(entry));\n}\n\n/**\n * Create a child logger with additional context\n */\nexport function createChildLogger(additionalContext: LogContext): ChildLogger {\n  return {\n    debug: (message: string, data?: unknown) => logDebug(message, data, additionalContext),\n    info: (message: string, data?: unknown) => logInfo(message, data, additionalContext),\n    warn: (message: string, data?: unknown) => logWarn(message, data, additionalContext),\n    error: (message: string, data?: unknown) => logError(message, data, additionalContext),\n    event: (event: string, data?: Record<string, unknown>) => logEvent(event, data, additionalContext),\n  };\n}\n\n/**\n * Child logger interface\n */\nexport interface ChildLogger {\n  debug: (message: string, data?: unknown) => void;\n  info: (message: string, data?: unknown) => void;\n  warn: (message: string, data?: unknown) => void;\n  error: (message: string, data?: unknown) => void;\n  event: (event: string, data?: Record<string, unknown>) => void;\n}\n\n/**\n * Timer utility for measuring operation duration\n */\nexport function createTimer(): Timer {\n  const startTime = Date.now();\n  return {\n    elapsed: () => Date.now() - startTime,\n    elapsedSeconds: () => (Date.now() - startTime) / 1000,\n    log: (operation: string, level: LogLevel = 'info') => {\n      const duration = Date.now() - startTime;\n      const message = `${operation} completed in ${duration}ms`;\n      const context: LogContext = { operation, duration };\n      \n      switch (level) {\n        case 'debug': logDebug(message, undefined, context); break;\n        case 'info': logInfo(message, undefined, context); break;\n        case 'warn': logWarn(message, undefined, context); break;\n        case 'error': logError(message, undefined, context); break;\n      }\n    },\n  };\n}\n\n/**\n * Timer interface\n */\nexport interface Timer {\n  elapsed: () => number;\n  elapsedSeconds: () => number;\n  log: (operation: string, level?: LogLevel) => void;\n}\n","/**\n * Retry with Exponential Backoff\n * Provides resilient API calls with configurable retry logic\n */\n\nimport { logWarn, logError, logDebug } from './loggerStructured.js';\n\n/**\n * Retry options\n */\nexport interface RetryOptions {\n  /** Maximum number of retry attempts (default: 3) */\n  maxRetries?: number;\n  /** Initial delay in milliseconds (default: 1000) */\n  initialDelayMs?: number;\n  /** Maximum delay in milliseconds (default: 30000) */\n  maxDelayMs?: number;\n  /** Backoff multiplier (default: 2) */\n  backoffMultiplier?: number;\n  /** Jitter factor 0-1 to randomize delay (default: 0.1) */\n  jitterFactor?: number;\n  /** Custom function to determine if error is retryable */\n  isRetryable?: (error: unknown) => boolean;\n  /** Callback before each retry attempt */\n  onRetry?: (attempt: number, error: unknown, delayMs: number) => void;\n  /** Operation name for logging */\n  operationName?: string;\n}\n\n/**\n * Default retry options\n */\nconst DEFAULT_OPTIONS: Required<Omit<RetryOptions, 'isRetryable' | 'onRetry' | 'operationName'>> = {\n  maxRetries: 3,\n  initialDelayMs: 1000,\n  maxDelayMs: 30000,\n  backoffMultiplier: 2,\n  jitterFactor: 0.1,\n};\n\n/**\n * Calculate exponential delay with optional jitter\n */\nexport function exponentialDelay(\n  attempt: number,\n  initialDelayMs: number,\n  backoffMultiplier: number,\n  maxDelayMs: number,\n  jitterFactor: number\n): number {\n  // Calculate base delay with exponential backoff\n  const baseDelay = initialDelayMs * Math.pow(backoffMultiplier, attempt - 1);\n  \n  // Cap at max delay\n  const cappedDelay = Math.min(baseDelay, maxDelayMs);\n  \n  // Add jitter\n  const jitter = cappedDelay * jitterFactor * (Math.random() * 2 - 1);\n  \n  return Math.max(0, Math.round(cappedDelay + jitter));\n}\n\n/**\n * Default function to determine if an error is retryable\n */\nfunction defaultIsRetryable(error: unknown): boolean {\n  if (error instanceof Error) {\n    const message = error.message.toLowerCase();\n    const name = error.name.toLowerCase();\n    \n    // Network errors\n    if (message.includes('network') || \n        message.includes('timeout') ||\n        message.includes('econnreset') ||\n        message.includes('econnrefused') ||\n        message.includes('socket hang up')) {\n      return true;\n    }\n    \n    // Rate limiting\n    if (message.includes('rate limit') ||\n        message.includes('too many requests') ||\n        message.includes('429')) {\n      return true;\n    }\n    \n    // Temporary server errors\n    if (message.includes('502') ||\n        message.includes('503') ||\n        message.includes('504') ||\n        message.includes('service unavailable') ||\n        message.includes('internal server error')) {\n      return true;\n    }\n    \n    // Transient errors\n    if (name.includes('transient') ||\n        message.includes('temporarily')) {\n      return true;\n    }\n  }\n  \n  // Check for HTTP status codes on response objects\n  if (typeof error === 'object' && error !== null) {\n    const statusCode = (error as Record<string, unknown>)['statusCode'] ?? \n                       (error as Record<string, unknown>)['status'];\n    if (typeof statusCode === 'number') {\n      // Retry on 429, 502, 503, 504\n      return [429, 502, 503, 504].includes(statusCode);\n    }\n  }\n  \n  return false;\n}\n\n/**\n * Sleep for a specified duration\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/**\n * Execute a function with retry and exponential backoff\n * \n * @param fn - Async function to execute\n * @param options - Retry options\n * @returns Result of the function\n * @throws Last error if all retries fail\n */\nexport async function retryWithBackoff<T>(\n  fn: () => Promise<T>,\n  options: RetryOptions = {}\n): Promise<T> {\n  const {\n    maxRetries = DEFAULT_OPTIONS.maxRetries,\n    initialDelayMs = DEFAULT_OPTIONS.initialDelayMs,\n    maxDelayMs = DEFAULT_OPTIONS.maxDelayMs,\n    backoffMultiplier = DEFAULT_OPTIONS.backoffMultiplier,\n    jitterFactor = DEFAULT_OPTIONS.jitterFactor,\n    isRetryable = defaultIsRetryable,\n    onRetry,\n    operationName = 'operation',\n  } = options;\n\n  let lastError: unknown;\n  \n  for (let attempt = 1; attempt <= maxRetries + 1; attempt++) {\n    try {\n      logDebug(`${operationName}: attempt ${attempt}/${maxRetries + 1}`);\n      return await fn();\n    } catch (error) {\n      lastError = error;\n      \n      // Check if we've exhausted retries\n      if (attempt > maxRetries) {\n        logError(`${operationName}: all ${maxRetries} retries exhausted`, {\n          error: error instanceof Error ? error.message : String(error),\n        });\n        break;\n      }\n      \n      // Check if error is retryable\n      if (!isRetryable(error)) {\n        logError(`${operationName}: non-retryable error`, {\n          error: error instanceof Error ? error.message : String(error),\n        });\n        break;\n      }\n      \n      // Calculate delay\n      const delayMs = exponentialDelay(\n        attempt,\n        initialDelayMs,\n        backoffMultiplier,\n        maxDelayMs,\n        jitterFactor\n      );\n      \n      logWarn(`${operationName}: attempt ${attempt} failed, retrying in ${delayMs}ms`, {\n        error: error instanceof Error ? error.message : String(error),\n        attempt,\n        delayMs,\n      });\n      \n      // Call onRetry callback if provided\n      if (onRetry) {\n        onRetry(attempt, error, delayMs);\n      }\n      \n      // Wait before retrying\n      await sleep(delayMs);\n    }\n  }\n  \n  throw lastError;\n}\n\n/**\n * Create a retry wrapper for a function\n */\nexport function withRetry<T extends unknown[], R>(\n  fn: (...args: T) => Promise<R>,\n  options: RetryOptions = {}\n): (...args: T) => Promise<R> {\n  return (...args: T) => retryWithBackoff(() => fn(...args), options);\n}\n\n/**\n * Retry decorator options for specific error types\n */\nexport const RETRY_PRESETS = {\n  /** Quick retry for transient network issues */\n  quick: {\n    maxRetries: 2,\n    initialDelayMs: 500,\n    maxDelayMs: 2000,\n    backoffMultiplier: 2,\n  } satisfies RetryOptions,\n  \n  /** Standard retry for API calls */\n  standard: {\n    maxRetries: 3,\n    initialDelayMs: 1000,\n    maxDelayMs: 10000,\n    backoffMultiplier: 2,\n  } satisfies RetryOptions,\n  \n  /** Aggressive retry for critical operations */\n  aggressive: {\n    maxRetries: 5,\n    initialDelayMs: 1000,\n    maxDelayMs: 60000,\n    backoffMultiplier: 2,\n  } satisfies RetryOptions,\n  \n  /** Rate limit specific retry (longer delays) */\n  rateLimit: {\n    maxRetries: 3,\n    initialDelayMs: 5000,\n    maxDelayMs: 60000,\n    backoffMultiplier: 3,\n  } satisfies RetryOptions,\n} as const;\n","/**\n * Validation Schemas\n * Zod schemas for runtime validation of inputs\n */\n\nimport { z } from 'zod';\n\n// ============================================\n// Azure DevOps Schemas\n// ============================================\n\n/**\n * Work Class Type enum\n */\nexport const WorkClassTypeSchema = z.enum([\n  'Critical/Escalation',\n  'Development',\n  'Fixed Date Delivery',\n  'Maintenance/Recurring Tasks',\n  'Standard',\n]);\n\n/**\n * Requires QA enum\n */\nexport const RequiresQASchema = z.enum(['Yes', 'No']);\n\n/**\n * Priority enum\n */\nexport const PrioritySchema = z.union([\n  z.literal(1),\n  z.literal(2),\n  z.literal(3),\n  z.literal(4),\n]);\n\n/**\n * Work item type enum\n */\nexport const WorkItemTypeSchema = z.enum([\n  'User Story',\n  'Task',\n  'Bug',\n  'Feature',\n  'Epic',\n  'Issue',\n  'Test Case',\n  'Test Plan',\n  'Test Suite',\n]);\n\n/**\n * Link type alias enum\n */\nexport const LinkTypeAliasSchema = z.enum([\n  'parent',\n  'child',\n  'related',\n  'predecessor',\n  'successor',\n  'duplicate',\n  'affects',\n]);\n\n/**\n * Work item fields schema (partial - only commonly used fields)\n */\nexport const WorkItemFieldsSchema = z.object({\n  // System fields\n  'System.Title': z.string().optional(),\n  'System.Description': z.string().optional(),\n  'System.State': z.string().optional(),\n  'System.AreaPath': z.string().optional(),\n  'System.IterationPath': z.string().optional(),\n  'System.AssignedTo': z.string().optional(),\n  'System.Tags': z.string().optional(),\n  // Microsoft VSTS Common fields\n  'Microsoft.VSTS.Scheduling.StoryPoints': z.number().optional(),\n  'Microsoft.VSTS.Common.Priority': PrioritySchema.optional(),\n  'Microsoft.VSTS.Common.AcceptanceCriteria': z.string().optional(),\n  // Microsoft VSTS TCM fields (Bug-specific)\n  'Microsoft.VSTS.TCM.ReproSteps': z.string().optional(),\n  'Microsoft.VSTS.TCM.SystemInfo': z.string().optional(),\n  // Custom fields\n  'Custom.WorkClassType': WorkClassTypeSchema.optional(),\n  'Custom.RequiresQA': RequiresQASchema.optional(),\n  'Custom.SFComponents': z.string().optional(),\n  'Custom.TechnicalNotes': z.string().optional(),\n  'Custom.RootCauseDetail': z.string().optional(),\n}).passthrough(); // Allow additional fields\n\n/**\n * Get work item options schema\n */\nexport const GetWorkItemOptionsSchema = z.object({\n  expand: z.enum(['None', 'Relations', 'Fields', 'Links', 'All']).optional(),\n  includeComments: z.boolean().optional(),\n  fields: z.array(z.string()).optional(),\n});\n\n/**\n * Create work item options schema\n */\nexport const CreateWorkItemOptionsSchema = z.object({\n  type: WorkItemTypeSchema,\n  title: z.string().min(1),\n  description: z.string().optional(),\n  parentId: z.number().positive().optional(),\n  areaPath: z.string().optional(),\n  iterationPath: z.string().optional(),\n  assignedTo: z.string().optional(),\n  tags: z.array(z.string()).optional(),\n  additionalFields: WorkItemFieldsSchema.optional(),\n});\n\n/**\n * Update work item options schema\n */\nexport const UpdateWorkItemOptionsSchema = z.object({\n  fields: WorkItemFieldsSchema.optional(),\n  comment: z.string().optional(),\n});\n\n/**\n * Search work items options schema\n */\nexport const SearchWorkItemsOptionsSchema = z.object({\n  searchText: z.string().optional(),\n  wiql: z.string().optional(),\n  workItemType: WorkItemTypeSchema.optional(),\n  state: z.string().optional(),\n  assignedTo: z.string().optional(),\n  areaPath: z.string().optional(),\n  iterationPath: z.string().optional(),\n  tags: z.array(z.string()).optional(),\n  top: z.number().positive().optional(),\n});\n\n/**\n * Link work items options schema\n */\nexport const LinkWorkItemsOptionsSchema = z.object({\n  sourceId: z.number().positive(),\n  targetId: z.number().positive(),\n  linkType: LinkTypeAliasSchema,\n  comment: z.string().optional(),\n});\n\n// ============================================\n// Salesforce Schemas\n// ============================================\n\n/**\n * Query options schema\n */\nexport const QueryOptionsSchema = z.object({\n  query: z.string().min(1),\n  useToolingApi: z.boolean().optional(),\n  allRows: z.boolean().optional(),\n  maxRecords: z.number().positive().optional(),\n});\n\n/**\n * Dependency discovery options schema\n */\nexport const MetadataTypeSchema = z.enum([\n  'CustomObject',\n  'CustomField',\n  'ApexClass',\n  'ApexTrigger',\n  'ApexPage',\n  'ApexComponent',\n  'AuraDefinitionBundle',\n  'LightningComponentBundle',\n  'Flow',\n  'FlowDefinition',\n  'ValidationRule',\n  'WorkflowRule',\n  'WorkflowFieldUpdate',\n  'WorkflowAlert',\n  'ProcessBuilder',\n  'CustomMetadataType',\n  'CustomSetting',\n  'CustomLabel',\n  'Layout',\n  'RecordType',\n  'FieldSet',\n  'CompactLayout',\n  'ListView',\n  'Report',\n  'Dashboard',\n  'PermissionSet',\n  'Profile',\n  'Unknown',\n]);\n\nexport const DiscoverDependenciesOptionsSchema = z.object({\n  rootType: MetadataTypeSchema,\n  rootName: z.string().min(1),\n  maxDepth: z.number().positive().optional(),\n  includeStandardObjects: z.boolean().optional(),\n  includeNamespaced: z.boolean().optional(),\n  excludeTypes: z.array(MetadataTypeSchema).optional(),\n  parallelQueries: z.number().positive().optional(),\n});\n\n// ============================================\n// Workflow Schemas\n// ============================================\n\n/**\n * Workflow status schema\n */\nexport const WorkflowStatusSchema = z.enum([\n  'pending',\n  'in_progress',\n  'paused',\n  'completed',\n  'failed',\n  'cancelled',\n]);\n\n/**\n * Workflow execution options schema\n */\nexport const WorkflowExecutionOptionsSchema = z.object({\n  workItemId: z.number().positive(),\n  phases: z.array(z.string()).optional(),\n  steps: z.array(z.string()).optional(),\n  dryRun: z.boolean().optional(),\n  verbose: z.boolean().optional(),\n  continueOnError: z.boolean().optional(),\n});\n\n// ============================================\n// Validation Helpers\n// ============================================\n\n/**\n * Validate data against a schema and return typed result\n */\nexport function validate<T>(schema: z.ZodSchema<T>, data: unknown): T {\n  return schema.parse(data);\n}\n\n/**\n * Safely validate data, returning result or undefined\n */\nexport function safeValidate<T>(schema: z.ZodSchema<T>, data: unknown): T | undefined {\n  const result = schema.safeParse(data);\n  return result.success ? result.data : undefined;\n}\n\n/**\n * Get validation errors as a formatted string\n */\nexport function getValidationErrors(schema: z.ZodSchema, data: unknown): string[] {\n  const result = schema.safeParse(data);\n  if (result.success) {\n    return [];\n  }\n  return result.error.errors.map(e => `${e.path.join('.')}: ${e.message}`);\n}\n","/**\n * Azure DevOps Work Item Links\n * Operations for linking work items together\n */\n\nimport { Operation, type JsonPatchOperation } from 'azure-devops-node-api/interfaces/common/VSSInterfaces.js';\nimport { createAdoConnection, type AdoConnectionConfig } from './adoClient.js';\nimport { getWorkItem } from './adoWorkItems.js';\nimport { retryWithBackoff, RETRY_PRESETS } from './lib/retryWithBackoff.js';\nimport { logInfo, logDebug, createTimer } from './lib/loggerStructured.js';\nimport { validate, LinkWorkItemsOptionsSchema } from './lib/validationSchemas.js';\nimport type { WorkItem } from './types/adoWorkItemTypes.js';\nimport {\n  type LinkWorkItemsOptions,\n  type GetRelationsOptions,\n  type RelationResult,\n  type ParsedRelation,\n  type LinkTypeAlias,\n  resolveLinkType,\n  parseLinkType,\n  extractWorkItemIdFromUrl,\n} from './types/adoLinkTypes.js';\n\n/**\n * Link two work items together\n * \n * @param options - Link options\n * @param config - Connection config\n * @returns Updated source work item\n */\nexport async function linkWorkItems(\n  options: LinkWorkItemsOptions,\n  config?: AdoConnectionConfig\n): Promise<WorkItem> {\n  const timer = createTimer();\n  const validatedOptions = validate(LinkWorkItemsOptionsSchema, options);\n\n  const { sourceId, targetId, linkType, comment } = validatedOptions;\n  const linkTypeName = resolveLinkType(linkType);\n\n  logInfo(`Linking work items: ${sourceId} -> ${targetId} (${linkType})`);\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  // Build the relation URL\n  const targetUrl = `${conn.orgUrl}/${conn.project}/_apis/wit/workItems/${targetId}`;\n\n  // Build patch document to add the link\n  const patchDoc: JsonPatchOperation[] = [\n    {\n      op: Operation.Add,\n      path: '/relations/-',\n      value: {\n        rel: linkTypeName,\n        url: targetUrl,\n        attributes: comment ? { comment } : {},\n      },\n    },\n  ];\n\n  logDebug(`Adding link: ${linkTypeName} to ${targetUrl}`);\n\n  const updatedItem = await retryWithBackoff(\n    () => witApi.updateWorkItem(\n      undefined, // customHeaders\n      patchDoc,\n      sourceId,\n      conn.project\n    ),\n    { ...RETRY_PRESETS.standard, operationName: `linkWorkItems(${sourceId}->${targetId})` }\n  );\n\n  if (!updatedItem) {\n    throw new Error(`Failed to link work items ${sourceId} -> ${targetId}`);\n  }\n\n  logInfo(`Successfully linked work items ${sourceId} -> ${targetId}`);\n  timer.log(`linkWorkItems(${sourceId}->${targetId})`);\n\n  return {\n    id: updatedItem.id ?? 0,\n    rev: updatedItem.rev ?? 0,\n    url: updatedItem.url ?? '',\n    fields: (updatedItem.fields ?? {}) as WorkItem['fields'],\n    relations: updatedItem.relations?.map(r => ({\n      rel: r.rel ?? '',\n      url: r.url ?? '',\n      attributes: r.attributes ?? {},\n    })) ?? [],\n  };\n}\n\n/**\n * Remove a link between two work items\n * \n * @param sourceId - Source work item ID\n * @param targetId - Target work item ID\n * @param linkType - Type of link to remove\n * @param config - Connection config\n * @returns Updated source work item\n */\nexport async function unlinkWorkItems(\n  sourceId: number,\n  targetId: number,\n  linkType: LinkTypeAlias,\n  config?: AdoConnectionConfig\n): Promise<WorkItem> {\n  const timer = createTimer();\n  \n  logInfo(`Unlinking work items: ${sourceId} -> ${targetId} (${linkType})`);\n\n  // First, get the work item to find the relation index\n  const workItem = await getWorkItem(sourceId, { expand: 'Relations' }, config);\n  \n  if (!workItem.relations || workItem.relations.length === 0) {\n    throw new Error(`Work item ${sourceId} has no relations`);\n  }\n\n  // Find the relation to remove\n  const linkTypeName = resolveLinkType(linkType);\n  const relationIndex = workItem.relations.findIndex(r => {\n    const relTargetId = extractWorkItemIdFromUrl(r.url);\n    return r.rel === linkTypeName && relTargetId === targetId;\n  });\n\n  if (relationIndex === -1) {\n    throw new Error(`No ${linkType} link found from ${sourceId} to ${targetId}`);\n  }\n\n  const conn = await createAdoConnection(config);\n  const witApi = await conn.getWorkItemTrackingApi();\n\n  // Build patch document to remove the link\n  const patchDoc: JsonPatchOperation[] = [\n    {\n      op: Operation.Remove,\n      path: `/relations/${relationIndex}`,\n    },\n  ];\n\n  logDebug(`Removing relation at index ${relationIndex}`);\n\n  const updatedItem = await retryWithBackoff(\n    () => witApi.updateWorkItem(\n      undefined,\n      patchDoc,\n      sourceId,\n      conn.project\n    ),\n    { ...RETRY_PRESETS.standard, operationName: `unlinkWorkItems(${sourceId}->${targetId})` }\n  );\n\n  if (!updatedItem) {\n    throw new Error(`Failed to unlink work items ${sourceId} -> ${targetId}`);\n  }\n\n  logInfo(`Successfully unlinked work items ${sourceId} -> ${targetId}`);\n  timer.log(`unlinkWorkItems(${sourceId}->${targetId})`);\n\n  return {\n    id: updatedItem.id ?? 0,\n    rev: updatedItem.rev ?? 0,\n    url: updatedItem.url ?? '',\n    fields: (updatedItem.fields ?? {}) as WorkItem['fields'],\n    relations: updatedItem.relations?.map(r => ({\n      rel: r.rel ?? '',\n      url: r.url ?? '',\n      attributes: r.attributes ?? {},\n    })) ?? [],\n  };\n}\n\n/**\n * Get all relations for a work item\n * \n * @param options - Get relations options\n * @param config - Connection config\n * @returns Relation result with parsed relations\n */\nexport async function getWorkItemRelations(\n  options: GetRelationsOptions,\n  config?: AdoConnectionConfig\n): Promise<RelationResult> {\n  const timer = createTimer();\n  const { workItemId, linkTypes } = options;\n\n  logInfo(`Getting relations for work item ${workItemId}`);\n\n  // Get work item with relations expanded\n  const workItem = await getWorkItem(workItemId, { expand: 'Relations' }, config);\n\n  if (!workItem.relations || workItem.relations.length === 0) {\n    logDebug(`Work item ${workItemId} has no relations`);\n    return { workItemId, relations: [] };\n  }\n\n  // Parse and filter relations\n  const parsedRelations: ParsedRelation[] = [];\n\n  for (const relation of workItem.relations) {\n    const friendlyType = parseLinkType(relation.rel);\n    \n    // Skip if we're filtering by link types and this doesn't match\n    if (linkTypes && linkTypes.length > 0 && friendlyType && !linkTypes.includes(friendlyType)) {\n      continue;\n    }\n\n    const targetId = extractWorkItemIdFromUrl(relation.url);\n    \n    if (targetId !== undefined) {\n      const parsed: ParsedRelation = {\n        targetId,\n        linkType: friendlyType ?? 'related',\n        linkTypeName: relation.rel as ParsedRelation['linkTypeName'],\n        url: relation.url,\n      };\n      \n      // Only add comment if it exists\n      const commentValue = relation.attributes?.comment;\n      if (typeof commentValue === 'string') {\n        parsed.comment = commentValue;\n      }\n      \n      parsedRelations.push(parsed);\n    }\n  }\n\n  logDebug(`Found ${parsedRelations.length} relations for work item ${workItemId}`);\n  timer.log(`getWorkItemRelations(${workItemId})`);\n\n  return { workItemId, relations: parsedRelations };\n}\n\n/**\n * Get related work items by link type\n * \n * @param workItemId - Work item ID\n * @param linkType - Type of link to filter by\n * @param config - Connection config\n * @returns Array of related work item IDs\n */\nexport async function getRelatedWorkItemIds(\n  workItemId: number,\n  linkType: LinkTypeAlias,\n  config?: AdoConnectionConfig\n): Promise<number[]> {\n  const result = await getWorkItemRelations(\n    { workItemId, linkTypes: [linkType] },\n    config\n  );\n  \n  return result.relations.map(r => r.targetId);\n}\n\n/**\n * Get parent work item ID\n * \n * @param workItemId - Work item ID\n * @param config - Connection config\n * @returns Parent work item ID or undefined\n */\nexport async function getParentWorkItemId(\n  workItemId: number,\n  config?: AdoConnectionConfig\n): Promise<number | undefined> {\n  const ids = await getRelatedWorkItemIds(workItemId, 'parent', config);\n  return ids[0];\n}\n\n/**\n * Get child work item IDs\n * \n * @param workItemId - Work item ID\n * @param config - Connection config\n * @returns Array of child work item IDs\n */\nexport async function getChildWorkItemIds(\n  workItemId: number,\n  config?: AdoConnectionConfig\n): Promise<number[]> {\n  return getRelatedWorkItemIds(workItemId, 'child', config);\n}\n\n/**\n * Check if a link exists between two work items\n * \n * @param sourceId - Source work item ID\n * @param targetId - Target work item ID\n * @param linkType - Type of link (optional - checks any if not specified)\n * @param config - Connection config\n * @returns True if link exists\n */\nexport async function hasLink(\n  sourceId: number,\n  targetId: number,\n  linkType?: LinkTypeAlias,\n  config?: AdoConnectionConfig\n): Promise<boolean> {\n  const options: GetRelationsOptions = { workItemId: sourceId };\n  if (linkType) {\n    options.linkTypes = [linkType];\n  }\n  \n  const result = await getWorkItemRelations(options, config);\n  \n  return result.relations.some(r => r.targetId === targetId);\n}\n","/**\n * Azure DevOps Link Types\n * Type definitions for work item relationships\n */\n\n/**\n * Standard link type names\n */\nexport type LinkTypeName =\n  | 'System.LinkTypes.Hierarchy-Forward'  // Parent\n  | 'System.LinkTypes.Hierarchy-Reverse'  // Child\n  | 'System.LinkTypes.Related'            // Related\n  | 'System.LinkTypes.Dependency-Forward' // Successor\n  | 'System.LinkTypes.Dependency-Reverse' // Predecessor\n  | 'Microsoft.VSTS.Common.Affects-Forward'\n  | 'Microsoft.VSTS.Common.Affects-Reverse'\n  | 'System.LinkTypes.Duplicate-Forward'\n  | 'System.LinkTypes.Duplicate-Reverse';\n\n/**\n * User-friendly link type aliases\n */\nexport type LinkTypeAlias =\n  | 'parent'\n  | 'child'\n  | 'related'\n  | 'predecessor'\n  | 'successor'\n  | 'duplicate'\n  | 'affects';\n\n/**\n * Mapping from friendly names to system link types\n */\nexport const LINK_TYPE_MAP: Record<LinkTypeAlias, LinkTypeName> = {\n  parent: 'System.LinkTypes.Hierarchy-Forward',\n  child: 'System.LinkTypes.Hierarchy-Reverse',\n  related: 'System.LinkTypes.Related',\n  predecessor: 'System.LinkTypes.Dependency-Reverse',\n  successor: 'System.LinkTypes.Dependency-Forward',\n  duplicate: 'System.LinkTypes.Duplicate-Forward',\n  affects: 'Microsoft.VSTS.Common.Affects-Forward',\n} as const;\n\n/**\n * Reverse mapping from system link types to friendly names\n */\nexport const LINK_TYPE_REVERSE_MAP: Record<LinkTypeName, LinkTypeAlias> = {\n  'System.LinkTypes.Hierarchy-Forward': 'parent',\n  'System.LinkTypes.Hierarchy-Reverse': 'child',\n  'System.LinkTypes.Related': 'related',\n  'System.LinkTypes.Dependency-Reverse': 'predecessor',\n  'System.LinkTypes.Dependency-Forward': 'successor',\n  'System.LinkTypes.Duplicate-Forward': 'duplicate',\n  'System.LinkTypes.Duplicate-Reverse': 'duplicate',\n  'Microsoft.VSTS.Common.Affects-Forward': 'affects',\n  'Microsoft.VSTS.Common.Affects-Reverse': 'affects',\n} as const;\n\n/**\n * Options for linking work items\n */\nexport interface LinkWorkItemsOptions {\n  sourceId: number;\n  targetId: number;\n  linkType: LinkTypeAlias;\n  comment?: string;\n}\n\n/**\n * Options for getting work item relations\n */\nexport interface GetRelationsOptions {\n  workItemId: number;\n  linkTypes?: LinkTypeAlias[];\n}\n\n/**\n * Relation result\n */\nexport interface RelationResult {\n  workItemId: number;\n  relations: ParsedRelation[];\n}\n\n/**\n * Parsed relation with friendly names\n */\nexport interface ParsedRelation {\n  targetId: number;\n  linkType: LinkTypeAlias;\n  linkTypeName: LinkTypeName;\n  url: string;\n  comment?: string;\n}\n\n/**\n * Helper to resolve link type alias to system name\n */\nexport function resolveLinkType(alias: LinkTypeAlias): LinkTypeName {\n  return LINK_TYPE_MAP[alias];\n}\n\n/**\n * Helper to parse link type name to alias\n */\nexport function parseLinkType(name: string): LinkTypeAlias | undefined {\n  return LINK_TYPE_REVERSE_MAP[name as LinkTypeName];\n}\n\n/**\n * Extract work item ID from relation URL\n */\nexport function extractWorkItemIdFromUrl(url: string): number | undefined {\n  const match = /\\/workItems\\/(\\d+)$/.exec(url);\n  return match ? parseInt(match[1], 10) : undefined;\n}\n"],"mappings":"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","names":["config","config","conn","Operation","config","Operation","config"]}